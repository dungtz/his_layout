<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>HIS - Kh√°m b·ªánh b√°c sƒ©</title>
    <style>
        :root {
            --bg: #f6f7f9;
            --card: #fff;
            --line: #e5e7eb;
            --txt: #111827;
            --muted: #6b7280;
            --primary: #2563eb;
            --secondary: #4b5563;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --sidebar-width: 250px;
            --right-sidebar-width: 250px;
            --font-family: 'Times New Roman';
        }

        * {
            box-sizing: border-box;
        }

        html,
        body {
            height: 100%;
            margin: 0;
            font: 14px/1.45 system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
            color: var(--txt);
            background: var(--bg);
            font-family: var(--font-family);
        }

        /* Layout t·ªïng th·ªÉ */
        .container {
            display: flex;
            height: 100vh;
            overflow: hidden;
        }

        /* Sidebar tr√°i - Danh s√°ch b·ªánh nh√¢n */
        .sidebar-left {
            width: var(--sidebar-width);
            background: var(--card);
            border-right: 1px solid var(--line);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* Main content - Ph·∫ßn kh√°m b·ªánh */
        .main-content {
            flex: 1;
            overflow-y: auto;
            padding: 0;
            background: var(--bg);
        }

        /* Sidebar ph·∫£i - Ch·ªâ ƒë·ªãnh, ƒë∆°n thu·ªëc */
        .sidebar-right {
            width: var(--right-sidebar-width);
            background: var(--card);
            border-left: 1px solid var(--line);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* Header chung */
        .header {
            padding: 12px 16px;
            background: var(--card);
            border-bottom: 1px solid var(--line);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h2 {
            margin: 0;
            font-size: 16px;
            font-weight: 600;
        }

        .header-actions {
            display: flex;
            gap: 8px;
        }

        /* Button styles */
        .btn {
            padding: 8px 12px;
            border: 1px solid var(--line);
            border-radius: 8px;
            background: #fff;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.2s;
        }

        .btn:hover {
            background: #f9fafb;
        }

        .btn.primary {
            background: var(--primary);
            color: #fff;
            border-color: var(--primary);
        }

        .btn.primary:hover {
            background: #1d4ed8;
        }

        .btn.danger {
            background: var(--danger);
            color: #fff;
            border-color: var(--danger);
        }

        .btn.danger:hover {
            background: #dc2626;
        }

        .btn.success {
            background: var(--success);
            color: #fff;
            border-color: var(--success);
        }

        .btn.success:hover {
            background: #059669;
        }

        /* Input styles */
        input[type="text"],
        input[type="date"],
        input[type="time"],
        select,
        textarea {
            width: 100%;
            padding: 5px 6px;
            border: 1px solid var(--line);
            border-radius: 8px;
            background: #fff;
            outline: none;
            font-size: 14px;
            font-family: var(--font-family);
        }

        textarea {
            min-height: 100px;
            resize: vertical;
            font-family: var(--font-family);
        }

        /* Patient list */
        .patient-list {
            flex: 1;
            overflow-y: auto;
            padding: 8px;
        }

        .patient-item {
            padding: 12px;
            background: var(--card);
            border: 1px solid var(--line);
            border-radius: 8px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .patient-item:hover {
            border-color: var(--primary);
            background: #f0f9ff;
        }

        .patient-item.active {
            border-color: var(--primary);
            background: #dbeafe;
        }

        .patient-info h3 {
            margin: 0 0 4px 0;
            font-size: 14px;
            font-weight: 600;
        }

        .patient-info p {
            margin: 0;
            font-size: 12px;
            color: var(--muted);
        }

        .patient-status {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 500;
            margin-top: 6px;
        }

        .status-waiting {
            background: #fef3c7;
            color: #92400e;
        }

        .status-examining {
            background: #dbeafe;
            color: #1d4ed8;
        }

        .status-completed {
            background: #d1fae5;
            color: #065f46;
        }

        /* Card styles */
        .card {
            background: var(--card);
            border: 1px solid var(--line);
            border-radius: 12px;
            box-shadow: 0 1px 0 rgba(0, 0, 0, .02);
        }

        .card-header {
            padding: 12px 16px;
            border-bottom: 1px solid var(--line);
            font-weight: 600;
            font-size: 15px;
        }

        .card-body {
            padding: 16px;
        }

        /* Grid layouts */
        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        .grid-3 {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 12px;
        }

        .grid-4 {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
        }

        .grid-8 {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 12px;
        }


        .grid-10 {
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            gap: 12px;
        }

        /* Field styles */
        .field {
            display: flex;
            flex-direction: column;
            gap: 6px;
            margin-bottom: 5px;
            font-family: var(--font-family);
        }

        .field label {
            font-size: 12px;
            color: var(--muted);
            font-weight: 500;
        }


        .section-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 4px;
            padding-bottom: 4px;
            border-bottom: 1px solid var(--line);
            font-family: var(--font-family);
        }

        /* Scrollable content */
        .scrollable {
            flex: 1;
            overflow-y: auto;
            padding: 16px;
        }

        /* Table styles */
        .table {
            width: 100%;
            border-collapse: collapse;
        }

        .table th {
            text-align: left;
            padding: 10px;
            background: #f9fafb;
            border-bottom: 2px solid var(--line);
            font-size: 12px;
            font-weight: 600;
            color: var(--secondary);
        }

        .table td {
            padding: 10px;
            border-bottom: 1px solid var(--line);
            font-size: 13px;
        }

        .table tbody tr:hover {
            background: #f9fafb;
        }

        /* Diagnosis and prescription */
        .prescription-list,
        .diagnosis-list {
            margin-top: 12px;
        }

        .prescription-item,
        .diagnosis-item {
            padding: 12px;
            background: #f9fafb;
            border: 1px solid var(--line);
            border-radius: 8px;
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
        }

        .prescription-info,
        .diagnosis-info {
            flex: 1;
        }

        .prescription-info h4,
        .diagnosis-info h4 {
            margin: 0 0 4px 0;
            font-size: 13px;
            font-weight: 600;
        }

        .prescription-info p,
        .diagnosis-info p {
            margin: 0;
            font-size: 12px;
            color: var(--muted);
        }

        /* Footer actions */
        .footer-actions {
            padding: 12px 16px;
            border-top: 1px solid var(--line);
            background: #f9fafb;
            display: flex;
            gap: 8px;
            justify-content: flex-end;
        }

        /* Detail info */
        .detail-info {
            background: #f9fafb;
            padding: 12px;
            border-radius: 8px;
        }

        .detail-info h3 {
            margin: 0 0 12px 0;
            font-size: 16px;
            font-weight: 600;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 6px;
            font-size: 13px;
        }

        .detail-label {
            color: var(--muted);
        }

        .detail-value {
            font-weight: 500;
        }

        /* Responsive adjustments */
        @media (max-width: 1200px) {
            :root {
                --sidebar-width: 250px;
                --right-sidebar-width: 300px;
            }

            .grid-4 {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }

            .sidebar-left,
            .sidebar-right {
                width: 100%;
                height: 200px;
            }

            .grid-2,
            .grid-3,
            .grid-4 {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <!-- Sidebar tr√°i: Danh s√°ch b·ªánh nh√¢n -->
        <div class="sidebar-left" style="display: flex; flex-direction: column; height: 100%;">
            <div style="display: flex; flex-direction: column; height: 60%;">
                <div class="header" style="display: flex; justify-content: space-between; align-items: center;">
                    <a href="home.html" style="display: flex; align-items: center;">
                        <div
                            style="width: 40px; height: 40px; background-color: #4CAF50; border-radius: 4px; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 18px;">
                            HIS
                        </div>
                    </a>
                    <button class="btn"
                        style="font-size: 11px; padding: 4px 8px; background-color: #2196F3; color: white; border: 1px solid #2196F3; border-radius: 4px;">B·ªánh
                        nh√¢n ti·∫øp theo</button>
                </div>
                <div class="department-selector" style="display: flex; gap: 8px; margin: 8px;">
                    <select
                        style="padding: 6px 8px; font-size: 12px; border-radius: 4px; border: 1px solid var(--line);">
                        <option value="">Ch·ªçn khoa</option>
                        <option value="noi">Khoa N·ªôi</option>
                        <option value="ngoai">Khoa Ngo·∫°i</option>
                        <option value="san">Khoa S·∫£n</option>
                        <option value="nha">Khoa Nha Khoa</option>
                    </select>
                    <select
                        style="padding: 6px 8px; font-size: 12px; border-radius: 4px; border: 1px solid var(--line);">
                        <option value="">Ch·ªçn ph√≤ng</option>
                        <option value="p1">Ph√≤ng 1</option>
                        <option value="p2">Ph√≤ng 2</option>
                        <option value="p3">Ph√≤ng 3</option>
                        <option value="p4">Ph√≤ng 4</option>
                    </select>
                </div>

                <div class="patient-list" style="overflow-y: auto; flex: 1;">
                    <!-- B·ªánh nh√¢n ƒëang kh√°m -->
                    <div class="patient-item active">
                        <div class="patient-info"
                            style="display: flex; justify-content: space-between; align-items: flex-start;">
                            <div>
                                <h3>Nguy·ªÖn VƒÉn A</h3>
                                <p>Tu·ªïi: 35 | Nam</p>
                                <p>Th·ªùi gian ƒë·∫øn: 09:30</p>
                            </div>

                            <!-- File Upload Popup -->
                            <div id="fileUploadPopup"
                                style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 90%; height: 90%; background: white; border-radius: 0; box-shadow: 0 5px 25px rgba(0,0,0,0.3); z-index: 2000; overflow: hidden;">
                                <div
                                    style="display: flex; justify-content: space-between; align-items: center; padding: 15px 20px; border-bottom: 1px solid #ddd;">
                                    <h3 style="margin: 0;">T·∫£i t·ªáp l√™n</h3>
                                    <button onclick="closeFileUploadPopup()"
                                        style="background: none; border: none; font-size: 24px; cursor: pointer;">&times;</button>
                                </div>

                                <div style="display: flex; height: calc(100% - 110px);">
                                    <!-- Main Content Area -->
                                    <div style="flex: 1; padding: 20px; overflow-y: auto;">
                                        <!-- File Upload Area -->
                                        <div id="fileUploadArea"
                                            style="display: none; height: 100%; flex-direction: column;">
                                            <div
                                                style="border: 2px dashed #ddd; border-radius: 8px; padding: 30px; text-align: center; height: 100%; background-color: #f9f9f9;">
                                                <div style="font-size: 48px; margin-bottom: 10px;">üìÇ</div>
                                                <p style="margin-bottom: 10px;">K√©o th·∫£ t·ªáp v√†o ƒë√¢y ho·∫∑c</p>
                                                <label>
                                                    <input type="file" id="fileInput" style="display: none;"
                                                        accept=".pdf,.jpg,.jpeg,.png">
                                                    <button type="button"
                                                        style="padding: 8px 20px; background-color: #2196F3; color: white; border: none; border-radius: 4px; cursor: pointer;">Ch·ªçn
                                                        t·ªáp</button>
                                                </label>
                                                <p style="font-size: 12px; color: #666; margin-top: 10px;">ƒê·ªãnh d·∫°ng h·ªó
                                                    tr·ª£:
                                                    PDF, JPG, PNG (t·ªëi ƒëa 10MB)</p>
                                            </div>
                                        </div>

                                        <!-- Camera Scan Area (Hidden by default) -->
                                        <div id="cameraScanArea"
                                            style="display: none; height: 100%; flex-direction: row;">
                                            <!-- Main Camera Area -->
                                            <div style="flex: 1; height: 100%;">
                                                <div
                                                    style=" border: 2px dashed #ddd; border-radius: 8px; padding: 30px; text-align: center; height: 100%; background-color: #f9f9f9;">
                                                    <div id="startCameraScan">
                                                        <div style="font-size: 48px; margin-bottom: 10px;">üéØ</div>
                                                        <p style="margin-bottom: 10px;">Cho ph√©p truy c·∫≠p camera ƒë·ªÉ qu√©t
                                                            t√†i li·ªáu
                                                        </p>

                                                        <button onclick="startCameraScan()"
                                                            style="padding: 8px 20px; background-color: #2196F3; color: white; border: none; border-radius: 4px; cursor: pointer;">B·∫≠t
                                                            camera</button>
                                                    </div>
                                                    <!-- Camera and Captured Photos Layout -->
                                                    <div id="camera"
                                                        style="display: none; width: 100%; height: 100%; flex-direction: row;">
                                                        <!-- Camera Preview Area (Left Side) -->
                                                        <div id="cameraPreview"
                                                            style="width: 85%; height: 100%; border: 1px solid #ddd; background-color: #000;">
                                                        </div>

                                                        <!-- Captured Photos Section (Right Side) -->
                                                        <div id="capturedPhotosSection"
                                                            style="display: flex; flex-direction: column; width: 15%; height: 100%; border-left: 1px solid #ddd; background-color: #f5f5f5; padding: 10px;">
                                                            <div
                                                                style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                                                <h4 style="margin: 0; font-size: 14px;">S·ªë l∆∞·ª£ng: <span
                                                                        id="photosCount">0</span></h4>
                                                                <button onclick="generatePDF()"
                                                                    style="padding: 6px 12px; background-color: #9C27B0; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 10px;">T·∫°o
                                                                    PDF</button>
                                                            </div>
                                                            <div id="capturedPhotos"
                                                                style="display: flex; flex-direction: column; gap: 8px; overflow-y: auto; padding: 8px; border: 1px dashed #ddd; border-radius: 4px; min-height: 80px; flex: 1; align-items: center;">
                                                                <!-- Thumbnails will be added here -->
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div id="cameraButtons"
                                                        style="display: none; gap: 10px; margin-bottom: 15px; width: 85%;">
                                                        <button onclick="captureImage()"
                                                            style="padding: 8px 20px; background-color: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer;">Ch·ª•p
                                                            ·∫£nh</button>
                                                        <button onclick="stopCameraScan()"
                                                            style="padding: 8px 20px; background-color: #f44336; color: white; border: none; border-radius: 4px; cursor: pointer;">D·ª´ng</button>
                                                    </div>
                                                </div>
                                                <!-- Right Sidebar inside CameraScanArea -->


                                            </div>


                                        </div>
                                    </div>

                                    <!-- Right Sidebar -->
                                    <div
                                        style="width: 250px; border-left: 1px solid #ddd; padding: 20px; background-color: #fafafa; display: flex; flex-direction: column; height: 100%;">
                                        <h4 style="margin-top: 0; margin-bottom: 20px; font-size: 16px;">Ph∆∞∆°ng th·ª©c t·∫£i
                                            l√™n</h4>

                                        <!-- Upload Options moved to sidebar -->
                                        <div style="display: flex; flex-direction: column; gap: 10px;">
                                            <div onclick="selectUploadMethod('file')" id="fileOption"
                                                style="padding: 15px; border: 2px solid #2196F3; border-radius: 6px; text-align: center; cursor: pointer; background-color: #e3f2fd;">
                                                <div style="font-size: 32px; margin-bottom: 8px;">üìÅ</div>
                                                <div style="font-weight: bold; font-size: 14px;">Ch·ªçn t·ª´ m√°y t√≠nh</div>
                                            </div>

                                            <div onclick="selectUploadMethod('camera')" id="cameraOption"
                                                style="padding: 15px; border: 2px solid #ddd; border-radius: 6px; text-align: center; cursor: pointer; background-color: #f5f5f5;">
                                                <div style="font-size: 32px; margin-bottom: 8px;">üì∑</div>
                                                <div style="font-weight: bold; font-size: 14px;">Ch·ª•p t·ª´ camera</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div
                                    style="display: flex; justify-content: flex-end; gap: 10px; padding: 15px 20px; border-top: 1px solid #ddd;">
                                    <button onclick="closeFileUploadPopup()"
                                        style="padding: 8px 20px; background-color: #f44336; color: white; border: none; border-radius: 4px; cursor: pointer;">H·ªßy</button>
                                    <button id="uploadButton" onclick="uploadSelectedFile()"
                                        style="padding: 8px 20px; background-color: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer;">T·∫£i
                                        l√™n</button>
                                </div>
                            </div>

                            <!-- Preview of Selected File -->
                            <div id="filePreview"
                                style="display: none; margin-top: 20px; padding: 15px; border: 1px solid #ddd; border-radius: 4px; background-color: #f9f9f9;">
                                <div
                                    style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                    <div style="font-weight: bold;" id="previewFileName"></div>
                                    <button onclick="removeSelectedFile()"
                                        style="background: none; border: none; color: #f44336; cursor: pointer; font-size: 16px;">&times;</button>
                                </div>
                                <div id="previewContent"
                                    style="width: 100%; height: 200px; background-color: #e0e0e0; display: flex; justify-content: center; align-items: center;">
                                </div>
                            </div>
                            <div style="display: flex; flex-direction: column; gap: 4px; align-items: flex-end;">
                                <span class="patient-status status-examining">ƒêang kh√°m</span>
                                <button class="btn"
                                    style="font-size: 11px; padding: 4px 8px; background-color: #f44336; color: white; border: 1px solid #f44336; border-radius: 4px;">B·ªè
                                    qua</button>
                            </div>
                        </div>
                    </div>
                    <!-- B·ªánh nh√¢n ch·ªù -->
                    <div class="patient-item">
                        <div class="patient-info"
                            style="display: flex; justify-content: space-between; align-items: flex-start;">
                            <div>
                                <h3>Tr·∫ßn Th·ªã B</h3>
                                <p>Tu·ªïi: 42 N·ªØ</p>
                                <p>Th·ªùi gian ƒë·∫øn: 09:45</p>
                            </div>
                            <div style="display: flex; flex-direction: column; gap: 4px; align-items: flex-end;">
                                <span class="patient-status status-waiting">Ch·ªù kh√°m</span>
                            </div>
                        </div>
                    </div>
                    <!-- B·ªánh nh√¢n ch·ªù -->
                    <div class="patient-item">
                        <div class="patient-info"
                            style="display: flex; justify-content: space-between; align-items: flex-start;">
                            <div>
                                <h3>Tr·∫ßn Th·ªã B</h3>
                                <p>Tu·ªïi: 42 | N·ªØ</p>
                                <p>Th·ªùi gian ƒë·∫øn: 09:45</p>
                            </div>
                            <div style="display: flex; flex-direction: column; gap: 4px; align-items: flex-end;">
                                <span class="patient-status status-waiting">Ch·ªù kh√°m</span>
                            </div>
                        </div>
                    </div>
                    <!-- B·ªánh nh√¢n ch·ªù -->
                    <div class="patient-item">
                        <div class="patient-info"
                            style="display: flex; justify-content: space-between; align-items: flex-start;">
                            <div>
                                <h3>Tr·∫ßn Th·ªã F</h3>
                                <p>Tu·ªïi: 42 N·ªØ</p>
                                <p>Th·ªùi gian ƒë·∫øn: 09:45</p>
                            </div>
                            <div style="display: flex; flex-direction: column; gap: 4px; align-items: flex-end;">
                                <span class="patient-status status-completed">ƒê√£ kh√°m</span>
                            </div>
                        </div>
                    </div>

                </div>
            </div>

            <div style="height: 40%; border-top: 1px solid var(--line); padding: 12px; overflow-y: auto;">
                <h3 style="margin-top: 0; margin-bottom: 12px; font-size: 16px;">L·ªãch s·ª≠ kh√°m b·ªánh</h3>
                <div id="patient-history" style="font-size: 14px;">
                    <!-- Th·∫ª l·ªãch s·ª≠ kh√°m b·ªánh 1 -->
                    <div
                        style="background-color: #f5f7fa; border-radius: 8px; padding: 12px; margin-bottom: 10px; border-left: 4px solid #4CAF50;">
                        <div
                            style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 8px;">
                            <div>
                                <div style="font-weight: 600; color: #333;">Ng√†y kh√°m: 15/04/2023</div>
                                <div style="color: #666; font-size: 13px; margin-top: 2px;">B√°c sƒ©: ƒê·∫∑ng VƒÉn H√πng</div>
                            </div>
                            <button
                                style="background-color: #2196F3; color: white; border: none; border-radius: 4px; padding: 4px 8px; font-size: 12px; cursor: pointer;">Xem</button>
                        </div>
                        <div style="color: #555; font-size: 13px;">Chu·∫©n ƒëo√°n: Vi√™m ph·ªïi c·∫•p t√≠nh</div>
                    </div>

                    <!-- Th·∫ª l·ªãch s·ª≠ kh√°m b·ªánh 2 -->
                    <div
                        style="background-color: #f5f7fa; border-radius: 8px; padding: 12px; margin-bottom: 10px; border-left: 4px solid #2196F3;">
                        <div
                            style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 8px;">
                            <div>
                                <div style="font-weight: 600; color: #333;">Ng√†y kh√°m: 22/03/2023</div>
                                <div style="color: #666; font-size: 13px; margin-top: 2px;">B√°c sƒ©: Nguy·ªÖn Th·ªã Lan</div>
                            </div>
                            <button
                                style="background-color: #2196F3; color: white; border: none; border-radius: 4px; padding: 4px 8px; font-size: 12px; cursor: pointer;">Xem</button>
                        </div>
                        <div style="color: #555; font-size: 13px;">Chu·∫©n ƒëo√°n: C·∫£m c√∫m m√πa xu√¢n</div>
                    </div>

                    <!-- Th·∫ª l·ªãch s·ª≠ kh√°m b·ªánh 3 -->
                    <div
                        style="background-color: #f5f7fa; border-radius: 8px; padding: 12px; margin-bottom: 10px; border-left: 4px solid #FF9800;">
                        <div
                            style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 8px;">
                            <div>
                                <div style="font-weight: 600; color: #333;">Ng√†y kh√°m: 10/01/2023</div>
                                <div style="color: #666; font-size: 13px; margin-top: 2px;">B√°c sƒ©: Tr·∫ßn Minh Tu·∫•n</div>
                            </div>
                            <button
                                style="background-color: #2196F3; color: white; border: none; border-radius: 4px; padding: 4px 8px; font-size: 12px; cursor: pointer;">Xem</button>
                        </div>
                        <div style="color: #555; font-size: 13px;">Chu·∫©n ƒëo√°n: TƒÉng huy·∫øt √°p nh·∫π</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main content: Ph·∫ßn kh√°m b·ªánh -->
        <div class="main-content">
            <div class="section"
                style="padding: 15px; position: sticky; top: 0; background-color: white; z-index: 100; box-shadow: 0 2px 4px rgba(0,0,0,0.1); width: 100%; margin: 0; padding: 0;">
                <div class="report"
                    style="display: flex; justify-content: space-around; align-items: center; background-color: #f5f7fa; border-bottom: 1px solid #e0e6ed;">
                    <div style="text-align: center; padding: 5px;">
                        <div style="font-size: 12px; color: #666; margin-bottom: 4px;">T·ªïng s·ªë b·ªánh nh√¢n</div>
                        <div style="font-size: 18px; font-weight: bold; color: #2c3e50;">43</div>
                    </div>
                    <div style="text-align: center; padding: 5px;">
                        <div style="font-size: 12px; color: #666; margin-bottom: 4px;">Ch·ªù kh√°m</div>
                        <div style="font-size: 18px; font-weight: bold; color: #FF9800;">12</div>
                    </div>
                    <div style="text-align: center; padding: 5px;">
                        <div style="font-size: 12px; color: #666; margin-bottom: 4px;">ƒêang kh√°m</div>
                        <div style="font-size: 18px; font-weight: bold; color: #2196F3;">5</div>
                    </div>
                    <div style="text-align: center; padding: 5px;">
                        <div style="font-size: 12px; color: #666; margin-bottom: 4px;">ƒê√£ kh√°m</div>
                        <div style="font-size: 18px; font-weight: bold; color: #4CAF50;">23</div>
                    </div>
                    <div style="text-align: center; padding: 5px;">
                        <div style="font-size: 12px; color: #666; margin-bottom: 4px;">B·ªè kh√°m</div>
                        <div style="font-size: 18px; font-weight: bold; color: #F44336;">3</div>
                    </div>
                </div>
                <div class="section" style="padding: 15px; font-family: Times New Roman;">
                <h2 class="section-title" style="margin-top: 5px;">A. TH√îNG TIN CHUNG:</h2>
                <div style="margin-bottom: 10px; font-family: Times New Roman;">
                    <div style="display: flex; margin-bottom: 8px;">
                        <div style="width: auto; padding-right: 10px;">1. H·ªç v√† t√™n (In hoa):</div>
                        <input type="text"
                            style="flex: 1; border: none; border-bottom: 1px dashed #000; outline: none; text-align: center;">
                        <div style="width: auto; padding-right: 10px; padding-left: 10px;">2. Ng√†y sinh:</div>
                        <input type="text"
                            style="width: 30px; border: none; border-bottom: 1px dashed #000; outline: none; text-align: center; margin-right: 15px;">
                        <div style="margin: 0 10px;">/</div>
                        <input type="text"
                            style="width: 30px; border: none; border-bottom: 1px dashed #000; outline: none; text-align: center; margin-right: 15px;">
                        <div style="margin: 0 10px;">/</div>
                        <input type="text"
                            style="width: 80px; border: none; border-bottom: 1px dashed #000; outline: none; text-align: center;">
                        <div style="margin-left: 15px; padding-right: 10px; padding-left: 10px;">Tu·ªïi:</div>
                        <input type="text"
                            style="width: 30px; border: none; border-bottom: 1px dashed #000; outline: none; text-align: center; margin-right: 15px;">
                        <div style="width: 80px; ">3. Gi·ªõi t√≠nh:</div>
                        <div >
                            <input type="radio" name="gender"> Nam
                        </div>
                        <div>
                            <input type="radio" name="gender"> N·ªØ
                        </div>
                    </div>
                    <div style="display: flex; margin-bottom: 8px;">
                        <div style="width: auto; padding-right: 10px;">4. ƒêi·ªán tho·∫°i:</div>
                        <input type="text"
                            style="flex: 1; border: none; border-bottom: 1px dashed #000; outline: none; text-align: center;">
                        <div style="width: auto; padding-right: 10px; padding-left: 10px;">5. Ngh·ªÅ nghi·ªáp:</div>
                        <input type="text"
                            style="flex: 1; border: none; border-bottom: 1px dashed #000; outline: none; text-align: center;">
                        <div style="width: auto; padding-right: 10px; padding-left: 10px;">6. D√¢n t·ªôc:</div>
                        <input type="text"
                            style="width: 120px; border: none; border-bottom: 1px dashed #000; outline: none; text-align: center;">
                        <div style="width: auto; padding-right: 10px; padding-left: 10px;">7. Qu·ªëc t·ªãch:</div>
                        <input type="text"
                            style="width: 120px; border: none; border-bottom: 1px dashed #000; outline: none; text-align: center;">
                    </div>
                    <div style="display: flex; margin-bottom: 8px;">
                        <div style="width: auto; padding-right: 10px;">8. ƒê·ªãa ch·ªâ:</div>
                        <input type="text"
                            style="flex: 1; border: none; border-bottom: 1px dashed #000; outline: none; text-align: center;">
                        <div style="width: auto; padding-right: 10px; padding-left: 10px;">9. ƒê·ªëi t∆∞·ª£ng:</div>
                        <div style="flex: 1;">
                            <input type="radio" name="doituong"> BHYT
                            <input type="radio" name="doituong" style="margin-left: 15px;"> Thu ph√≠
                            <input type="radio" name="doituong" style="margin-left: 15px;"> Mi·ªÖn
                            <input type="radio" name="doituong" style="margin-left: 15px;"> Kh√°c
                        </div>
                    </div>
                    <div style="display: flex; margin-bottom: 8px;">
                        <div style="width: auto; padding-right: 10px;">10. S·ªë th·∫ª BHYT:</div>
                        <input type="text"
                            style="width: 120px; border: none; border-bottom: 1px dashed #000; outline: none; text-align: center;">
                        <div style="width: auto; padding-right: 10px; padding-left: 10px;">11. S·ªë CƒÉn c∆∞·ªõc:</div>
                        <input type="text"
                            style="width: 120px; border: none; border-bottom: 1px dashed #000; outline: none; text-align: center;">
                        <div style="width: auto; padding-right: 10px; padding-left: 10px;">12. Ng∆∞·ªùi li√™n h·ªá:</div>
                        <input type="text"
                            style="width: 120px; border: none; border-bottom: 1px dashed #000; outline: none; text-align: center;">
                        <div style="width: auto; padding-right: 10px; padding-left: 10px;">ƒêi·ªán tho·∫°i:</div>
                        <input type="text"
                            style="flex: 1; border: none; border-bottom: 1px dashed #000; outline: none; text-align: center;">
                    </div>
                </div>
            </div>
            </div>

            

            <div class="section" style="padding: 15px; font-family: Times New Roman;">
                <h2 class="section-title" style="margin-top: 5px;">B. TH√îNG TIN KH√ÅM B·ªÜNH</h2>

                <!-- Ph·∫ßn 1: L√Ω do v√†o vi·ªán, v·∫•n ƒë·ªÅ s·ª©c kh·ªèe -->
                <div style="display: flex; margin-left: 15px;">
                    <div style="font-weight: bold;">I. L√ù DO V√ÄO VI·ªÜN, V·∫§N ƒê·ªÄ S·ª®C KH·ªéE:</div>
                    <input type="text" style="flex: 1; border: none; border-bottom: 1px dashed #000; outline: none; margin-left: 15px;">
                </div>

                <!-- Ph·∫ßn 2: H·ªèi b·ªánh -->
                <div style="margin-left: 15px;">

                    <div style="font-weight: bold;">II. H·ªéI B·ªÜNH</div>

                    <!-- Qu√° tr√¨nh b·ªánh l√Ω -->
                    <div style="margin-left: 20px; margin-bottom: 10px;">
                        <div style="font-weight: bold; margin-bottom: 5px;">1. Qu√° tr√¨nh b·ªánh l√Ω v√† di·ªÖn bi·∫øn l√¢m s√†ng:
                        </div>
                        <textarea
                            style="flex: 1; border: none; border-bottom: 1px dashed #000; outline: none;"></textarea>
                    </div>

                    <!-- Ti·ªÅn s·ª≠ b·ªánh -->
                    <div style="margin-left: 20px;">
                        <div style="font-weight: bold; margin-bottom: 10px;">2. Ti·ªÅn s·ª≠ b·ªánh:</div>

                        <div style="margin-bottom: 10px;">
                            <div style="display: flex; gap: 10px; margin-bottom: 5px;">
                                <div style="width: 100px;">D·ªã ·ª©ng:</div>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="radio" name="allergies" value="no"> Kh√¥ng
                                </label>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="radio" name="allergies" value="yes"> C√≥, ghi r√µ:
                                </label>
                                <input type="text"
                                    style="flex: 1; border: none; border-bottom: 1px dashed #000; outline: none;">
                            </div>
                        </div>

                        <div style="margin-bottom: 10px;">
                            <div style="display: flex; gap: 10px; margin-bottom: 5px;">
                                <div style="width: 100px;">B·∫£n th√¢n:</div>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="radio" name="allergies" value="no"> Kh√¥ng
                                </label>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="radio" name="allergies" value="yes"> C√≥, ghi r√µ:
                                </label>
                                <input type="text"
                                    style="flex: 1; border: none; border-bottom: 1px dashed #000; outline: none;">
                            </div>
                        </div>

                        <div style="margin-bottom: 10px;">
                            <div style="display: flex; gap: 10px; margin-bottom: 5px;">
                                <div style="width: 100px;">Gia ƒë√¨nh:</div>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="radio" name="allergies" value="no"> Kh√¥ng
                                </label>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="radio" name="allergies" value="yes"> C√≥, ghi r√µ:
                                </label>
                                <input type="text"
                                    style="flex: 1; border: none; border-bottom: 1px dashed #000; outline: none;">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Ph·∫ßn 3: Kh√°m b·ªánh -->
                <div style="margin-left: 20px; margin-bottom: 10px;">
                    <div style="font-weight: bold; margin-bottom: 10px;">III. KH√ÅM B·ªÜNH</div>

                    <div style="margin-left: 20px;">
                        <div style="font-weight: bold; margin-bottom: 8px;">1. To√†n th√¢n:</div>

                        <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                            <label style="display: flex; align-items: center; gap: 5px;">
                                <input type="radio" name="generalCondition" value="normal"> B√¨nh th∆∞·ªùng
                            </label>
                            <label style="display: flex; align-items: center; gap: 5px;">
                                <input type="radio" name="generalCondition" value="abnormal"> B·∫•t th∆∞·ªùng, ghi r√µ:
                            </label>
                        </div>

                        <!-- V√πng nh·∫≠p li·ªáu ch√≠nh v·ªõi ƒë∆∞·ªùng k·∫ª ƒë·ª©t -->
                        <div style="display: flex; position: relative; margin-bottom: 20px;">
                            <div style="flex: 1; margin-right: 20px;">
                                <!-- Nh·ªØng d√≤ng k·∫ª ƒë·ª©t -->
                                
                            <textarea style="flex: 1; border: none; border-bottom: 1px dashed #000; outline: none;"></textarea>
                            </div>

                            <!-- H·ªôp b√™n ph·∫£i: K·∫øt qu·∫£ kh√°m b·ªánh -->
                            <div style="border: 1px solid #000; width: 220px; padding: 5px;">
                                <div style="margin-bottom: 5px;">
                                    <span>M·∫°ch </span>
                                    <input type="text"
                                        style="width: 80px; border: none; border-bottom: 1px dashed #000; outline: none; text-align: center;">
                                    / ph√∫t
                                </div>
                                <div style="margin-bottom: 5px;">
                                    <span>Nhi·ªát ƒë·ªô </span>
                                    <input type="text"
                                        style="width: 80px; border: none; border-bottom: 1px dashed #000; outline: none; text-align: center;">
                                    ¬∞C
                                </div>
                                <div style="margin-bottom: 5px;">
                                    <span>Huy·∫øt √°p </span>
                                    <input type="text"
                                        style="width: 35px; border: none; border-bottom: 1px dashed #000; outline: none; text-align: center;">
                                    /
                                    <input type="text"
                                        style="width: 35px; border: none; border-bottom: 1px dashed #000; outline: none; text-align: center;">
                                    mmHg
                                </div>
                                <div style="margin-bottom: 5px;">
                                    <span>Nh·ªãp th·ªü </span>
                                    <input type="text"
                                        style="width: 80px; border: none; border-bottom: 1px dashed #000; outline: none; text-align: center;">
                                    / ph√∫t
                                </div>
                                <div style="margin-bottom: 5px;">
                                    <span>C√¢n n·∫∑ng </span>
                                    <input type="text"
                                        style="width: 80px; border: none; border-bottom: 1px dashed #000; outline: none; text-align: center;">
                                    kg
                                </div>
                                <div>
                                    <span>Chi·ªÅu cao </span>
                                    <input type="text"
                                        style="width: 80px; border: none; border-bottom: 1px dashed #000; outline: none; text-align: center;">
                                    cm
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 2. C√°c c∆° quan -->
                    <div style="margin-bottom: 15px; margin-left: 20px;">
                        <div style="font-weight: bold; margin-bottom: 10px;">2. C√°c c∆° quan</div>

                        <div style="margin-bottom: 10px;">
                            <div style="display: flex; gap: 10px; margin-bottom: 5px;">
                                <div style="width: 120px;">Tu·∫ßn ho√†n:</div>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="radio" name="circulatory" value="normal"> B√¨nh th∆∞·ªùng
                                </label>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="radio" name="circulatory" value="abnormal"> B·∫•t th∆∞·ªùng, ghi r√µ:
                                </label>
                                <div style="flex: 1; display: flex; gap: 10px;">
                                    <select
                                        style="flex: 1; max-width: 200px; border: none; border-bottom: 1px dashed #000; outline: none; padding: 0; background: transparent; appearance: none; font-family: 'Times New Roman' !important; ">
                                        <option value="">Nh·∫≠p ƒë·ªÉ t√¨m...</option>
                                        <!-- Th√™m c√°c t√πy ch·ªçn v√†o ƒë√¢y -->
                                    </select>
                                    <input type="text"
                                        style="flex: 1; border: none; border-bottom: 1px dashed #000; outline: none;">
                                </div>
                            </div>
                        </div>

                        <div style="margin-bottom: 10px;">
                            <div style="display: flex; gap: 10px; margin-bottom: 5px;">
                                <div style="width: 120px;">H√¥ h·∫•p:</div>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="radio" name="respiratory" value="normal"> B√¨nh th∆∞·ªùng
                                </label>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="radio" name="respiratory" value="abnormal"> B·∫•t th∆∞·ªùng, ghi r√µ:
                                </label>
                                <div style="flex: 1; display: flex; gap: 10px;">
                                    <select
                                        style="flex: 1; max-width: 200px; border: none; border-bottom: 1px dashed #000; outline: none; padding: 0; background: transparent; appearance: none; font-family: 'Times New Roman' !important; ">
                                        <option value="">Nh·∫≠p ƒë·ªÉ t√¨m...</option>
                                        <!-- Th√™m c√°c t√πy ch·ªçn v√†o ƒë√¢y -->
                                    </select>
                                    <input type="text"
                                        style="flex: 1; border: none; border-bottom: 1px dashed #000; outline: none;">
                                </div>
                            </div>
                        </div>

                        <div style="margin-bottom: 10px;">
                            <div style="display: flex; gap: 10px; margin-bottom: 5px;">
                                <div style="width: 120px;">Ti√™u h√≥a:</div>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="radio" name="digestive" value="normal"> B√¨nh th∆∞·ªùng
                                </label>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="radio" name="digestive" value="abnormal"> B·∫•t th∆∞·ªùng, ghi r√µ:
                                </label>
                                <div style="flex: 1; display: flex; gap: 10px;">
                                    <select
                                        style="flex: 1; max-width: 200px; border: none; border-bottom: 1px dashed #000; outline: none; padding: 0; background: transparent; appearance: none; font-family: 'Times New Roman' !important; ">
                                        <option value="">Nh·∫≠p ƒë·ªÉ t√¨m...</option>
                                        <!-- Th√™m c√°c t√πy ch·ªçn v√†o ƒë√¢y -->
                                    </select>
                                    <input type="text"
                                        style="flex: 1; border: none; border-bottom: 1px dashed #000; outline: none;">
                                </div>
                            </div>
                        </div>

                        <div style="margin-bottom: 10px;">
                            <div style="display: flex; gap: 10px; margin-bottom: 5px;">
                                <div style="width: 120px;">Th·∫≠n - ti·∫øt ni·ªáu:</div>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="radio" name="urinary" value="normal"> B√¨nh th∆∞·ªùng
                                </label>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="radio" name="urinary" value="abnormal"> B·∫•t th∆∞·ªùng, ghi r√µ:
                                </label>
                                <div style="flex: 1; display: flex; gap: 10px;">
                                    <select
                                        style="flex: 1; max-width: 200px; border: none; border-bottom: 1px dashed #000; outline: none; padding: 0; background: transparent; appearance: none; font-family: 'Times New Roman' !important; ">
                                        <option value="">Nh·∫≠p ƒë·ªÉ t√¨m...</option>
                                        <!-- Th√™m c√°c t√πy ch·ªçn v√†o ƒë√¢y -->
                                    </select>
                                    <input type="text"
                                        style="flex: 1; border: none; border-bottom: 1px dashed #000; outline: none;">
                                </div>
                            </div>
                        </div>

                        <div style="margin-bottom: 10px;">
                            <div style="display: flex; gap: 10px; margin-bottom: 5px;">
                                <div style="width: 120px;">Th·∫ßn kinh:</div>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="radio" name="nervous" value="normal"> B√¨nh th∆∞·ªùng
                                </label>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="radio" name="nervous" value="abnormal"> B·∫•t th∆∞·ªùng, ghi r√µ:
                                </label>
                                <div style="flex: 1; display: flex; gap: 10px;">
                                    <select
                                        style="flex: 1; max-width: 200px; border: none; border-bottom: 1px dashed #000; outline: none; padding: 0; background: transparent; appearance: none; font-family: 'Times New Roman' !important; ">
                                        <option value="">Nh·∫≠p ƒë·ªÉ t√¨m...</option>
                                        <!-- Th√™m c√°c t√πy ch·ªçn v√†o ƒë√¢y -->
                                    </select>
                                    <input type="text"
                                    style="flex: 1; border: none; border-bottom: 1px dashed #000; outline: none;">
                                </div>
                            </div>

                        </div>

                        <div style="margin-bottom: 10px;">
                            <div style="display: flex; gap: 10px; margin-bottom: 5px;">
                                <div style="width: 120px;">C∆° - x∆∞∆°ng - kh·ªõp:</div>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="radio" name="musculoskeletal" value="normal"> B√¨nh th∆∞·ªùng
                                </label>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="radio" name="musculoskeletal" value="abnormal"> B·∫•t th∆∞·ªùng, ghi r√µ:
                                </label>
                                <div style="flex: 1; display: flex; gap: 10px;">
                                    <select
                                        style="flex: 1; max-width: 200px; border: none; border-bottom: 1px dashed #000; outline: none; padding: 0; background: transparent; appearance: none; font-family: 'Times New Roman' !important; ">
                                        <option value="">Nh·∫≠p ƒë·ªÉ t√¨m...</option>
                                        <!-- Th√™m c√°c t√πy ch·ªçn v√†o ƒë√¢y -->
                                    </select>
                                    <input type="text"
                                    style="flex: 1; border: none; border-bottom: 1px dashed #000; outline: none;">
                                </div>
                            </div>

                        </div>

                        <div style="margin-bottom: 10px;">
                            <div style="display: flex; gap: 10px; margin-bottom: 5px;">
                                <div style="width: 120px;">Tai - m≈©i - h·ªçng:</div>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="radio" name="ent" value="normal"> B√¨nh th∆∞·ªùng
                                </label>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="radio" name="ent" value="abnormal"> B·∫•t th∆∞·ªùng, ghi r√µ:
                                </label>
                                <div style="flex: 1; display: flex; gap: 10px;">
                                    <select
                                        style="flex: 1; max-width: 200px; border: none; border-bottom: 1px dashed #000; outline: none; padding: 0; background: transparent; appearance: none; font-family: 'Times New Roman' !important; ">
                                        <option value="">Nh·∫≠p ƒë·ªÉ t√¨m...</option>
                                        <!-- Th√™m c√°c t√πy ch·ªçn v√†o ƒë√¢y -->
                                    </select>
                                    <input type="text"
                                    style="flex: 1; border: none; border-bottom: 1px dashed #000; outline: none;">
                                </div>
                            </div>

                        </div>

                        <div style="margin-bottom: 10px;">
                            <div style="display: flex; gap: 10px; margin-bottom: 5px;">
                                <div style="width: 120px;">RƒÉng - h√†m - m·∫∑t:</div>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="radio" name="dental" value="normal"> B√¨nh th∆∞·ªùng
                                </label>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="radio" name="dental" value="abnormal"> B·∫•t th∆∞·ªùng, ghi r√µ:
                                </label>
                                <div style="flex: 1; display: flex; gap: 10px;">
                                    <select
                                        style="flex: 1; max-width: 200px; border: none; border-bottom: 1px dashed #000; outline: none; padding: 0; background: transparent; appearance: none; font-family: 'Times New Roman' !important; ">
                                        <option value="">Nh·∫≠p ƒë·ªÉ t√¨m...</option>
                                        <!-- Th√™m c√°c t√πy ch·ªçn v√†o ƒë√¢y -->
                                    </select>
                                    <input type="text"
                                    style="flex: 1; border: none; border-bottom: 1px dashed #000; outline: none;">
                                </div>
                            </div>

                        </div>

                        <div style="margin-bottom: 10px;">
                            <div style="display: flex; gap: 10px; margin-bottom: 5px;">
                                <div style="width: 120px;">M·∫Øt:</div>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="radio" name="eyes" value="normal"> B√¨nh th∆∞·ªùng
                                </label>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="radio" name="eyes" value="abnormal"> B·∫•t th∆∞·ªùng, ghi r√µ:
                                </label>
                                <div style="flex: 1; display: flex; gap: 10px;">
                                    <select
                                        style="flex: 1; max-width: 200px; border: none; border-bottom: 1px dashed #000; outline: none; padding: 0; background: transparent; appearance: none; font-family: 'Times New Roman' !important; ">
                                        <option value="">Nh·∫≠p ƒë·ªÉ t√¨m...</option>
                                        <!-- Th√™m c√°c t√πy ch·ªçn v√†o ƒë√¢y -->
                                    </select>
                                    <input type="text"
                                    style="flex: 1; border: none; border-bottom: 1px dashed #000; outline: none;">
                                </div>
                            </div>
                        </div>

                        <div style="margin-bottom: 10px;">
                            <div style="display: flex; gap: 10px; margin-bottom: 5px;">
                                <div style="width: 120px;">B·ªánh l√Ω kh√°c:</div>
                                <div style="flex: 1; display: flex; gap: 10px;">
                                    <select
                                        style="flex: 1; max-width: 200px; border: none; border-bottom: 1px dashed #000; outline: none; padding: 0; background: transparent; appearance: none; font-family: 'Times New Roman' !important; ">
                                        <option value="">Nh·∫≠p ƒë·ªÉ t√¨m...</option>
                                        <!-- Th√™m c√°c t√πy ch·ªçn v√†o ƒë√¢y -->
                                    </select>
                                    <input type="text"
                                    style="flex: 1; border: none; border-bottom: 1px dashed #000; outline: none;">
                                </div>
                            </div>
                        </div>

                        <!-- 4. Ch·∫©n ƒëo√°n l√∫c v√†o vi·ªán -->
                        <div style="margin-bottom: 15px;">
                            <div style="font-weight: bold; margin-bottom: 10px;">4. Ch·∫©n ƒëo√°n l√∫c v√†o vi·ªán (T√™n b·ªánh k√®m
                                theo m√£ ICD):</div>
                            <div style="flex: 1; display: flex; gap: 10px;">
                                <select
                                        style="flex: 1; max-width: 200px; border: none; border-bottom: 1px dashed #000; outline: none; padding: 0; background: transparent; appearance: none; font-family: 'Times New Roman' !important; ">
                                        <option value="">Nh·∫≠p ƒë·ªÉ t√¨m...</option>
                                    <!-- Th√™m c√°c t√πy ch·ªçn v√†o ƒë√¢y -->
                                </select>
                                <input type="text"
                                    style="flex: 1; border: none; border-bottom: 1px dashed #000; outline: none;">
                            </div>
                        </div>

                    <!-- 6. Ch·∫©n ƒëo√°n khi ra vi·ªán -->
                    <div style="margin-bottom: 15px;">
                        <div style="font-weight: bold; margin-bottom: 10px;">6. Ch·∫©n ƒëo√°n khi ra vi·ªán (T√™n b·ªánh k√®m theo m√£
                            ICD):</div>

                        <div style="flex: 1; max-width: 200px; margin-bottom: 10px; font-weight: bold;"> B·ªánh ch√≠nh</div>

                        <div style="flex: 1; display: flex; gap: 10px;margin-bottom: 10px; margin-left: 10px;">

                            <select
                                        style="flex: 1; max-width: 200px; border: none; border-bottom: 1px dashed #000; outline: none; padding: 0; background: transparent; appearance: none; font-family: 'Times New Roman' !important; ">
                                        <option value="">Nh·∫≠p ƒë·ªÉ t√¨m...</option>
                                <!-- Th√™m c√°c t√πy ch·ªçn v√†o ƒë√¢y -->
                            </select>
                            <input type="text"
                                style="flex: 1; border: none; border-bottom: 1px dashed #000; outline: none;">
                        </div>

                         <div style="flex: 1; max-width: 200px; margin-bottom: 10px;font-weight: bold;"> B·ªánh k√®m theo</div>
                        
                        <div style="flex: 1; display: flex; gap: 10px; margin-left: 10px;">

                            <select
                                        style="flex: 1; max-width: 200px; border: none; border-bottom: 1px dashed #000; outline: none; padding: 0; background: transparent; appearance: none; font-family: 'Times New Roman' !important; ">
                                        <option value="">Nh·∫≠p ƒë·ªÉ t√¨m...</option>
                                <!-- Th√™m c√°c t√πy ch·ªçn v√†o ƒë√¢y -->
                            </select>
                            <input type="text"
                                style="flex: 1; border: none; border-bottom: 1px dashed #000; outline: none;">
                        </div>
                        
                        <div style="flex: 1; display: flex; gap: 10px; margin-left: 10px;">

                            <select
                                        style="flex: 1; max-width: 200px; border: none; border-bottom: 1px dashed #000; outline: none; padding: 0; background: transparent; appearance: none; font-family: 'Times New Roman' !important; ">
                                        <option value="">Nh·∫≠p ƒë·ªÉ t√¨m...</option>
                                <!-- Th√™m c√°c t√πy ch·ªçn v√†o ƒë√¢y -->
                            </select>
                            <input type="text"
                                style="flex: 1; border: none; border-bottom: 1px dashed #000; outline: none;">
                        </div>
                        

                    </div>

                    </div>
                </div>
            </div>    
            <div class="footer-actions"
                style="position: sticky; bottom: 0; background-color: white; border-top: 1px solid #ddd; padding: 10px; z-index: 100; display: flex; gap: 10px; margin: 0px !important;">
                <button class="btn" onclick="resetForm()">Xo√° h·∫øt</button>
                <button class="btn primary" onclick="saveExamination()">L∆∞u th√¥ng tin kh√°m b·ªánh</button>
                <button class="btn primary" onclick="endExamination()">K·∫øt th√∫c kh√°m</button>
            </div>
        </div>
        
        <!-- Sidebar ph·∫£i: Ch·ªâ ƒë·ªãnh, ƒë∆°n thu·ªëc -->
        <div class="sidebar-right">
                <div class="sidebar-right" style="display: flex; flex-direction: column; height: 100%;">

                <!-- Ph·∫ßn 1: Danh s√°ch ch·ªâ ƒë·ªãnh - C·ªë ƒë·ªãnh 33% chi·ªÅu cao -->
                <div class="card" style="margin-bottom: 0; flex: 1; min-height: 0; display: flex; flex-direction: column;">
                    <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
                        <span>Ch·ªâ ƒë·ªãnh y t·∫ø (1/3)</span>
                        <button class="btn primary" style="font-size: 11px; padding: 4px 8px;"
                            onclick="openAddPrescriptionPopup()">Th√™m ch·ªâ ƒë·ªãnh</button>

                        <!-- Popup th√™m ch·ªâ ƒë·ªãnh y t·∫ø -->
                        <div id="prescriptionPopup"
                            style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); z-index: 1000; justify-content: center; align-items: center;">
                            <div
                                style="background-color: white; border-radius: 8px; width: 90%; height: 90%; display: flex; flex-direction: column;">
                                <!-- Header -->
                                <div
                                    style="padding: 15px; border-bottom: 1px solid #ddd; display: flex; justify-content: space-between; align-items: center;">
                                    <h3 style="margin: 0;">Th√™m ch·ªâ ƒë·ªãnh y t·∫ø</h3>
                                    <button onclick="closePrescriptionPopup()"
                                        style="background: none; border: none; font-size: 24px; cursor: pointer;">&times;</button>
                                </div>

                                <!-- Body divided vertically -->
                                <div style="display: flex; flex: 1; overflow: hidden;">
                                    <!-- Left side: List of services -->
                                    <div
                                        style="width: 50%; border-right: 1px solid #ddd; display: flex; flex-direction: column; height: 100%;">

                                        <!-- Part 1: Search and service tabs -->
                                        <div style="padding: 15px; border-bottom: 1px solid #eee;">
                                            <div style="display: flex; gap: 10px;">
                                                <input type="text" placeholder="T√¨m ki·∫øm d·ªãch v·ª•..."
                                                    style="flex: 1; padding: 6px; border: 1px solid #ddd; border-radius: 4px; font-size: 12px;">
                                                <button class="btn" style="padding: 6px 12px; font-size: 12px;">L·ªçc</button>
                                            </div>
                                        </div>

                                        <!-- Part 2: Service list table (scrollable) -->
                                        <div style="flex: 1; overflow-y: auto; padding: 0 15px 15px;">
                                            <div style="border: 1px solid #ddd; border-radius: 4px;">
                                                <table style="width: 100%; border-collapse: collapse; font-size: 12px;">
                                                    <thead>
                                                        <tr style="background-color: #f5f5f5;">
                                                            <th
                                                                style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">
                                                                Lo·∫°i d·ªãch v·ª•</th>
                                                            <th
                                                                style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">
                                                                T√™n d·ªãch v·ª•</th>
                                                            <th
                                                                style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">
                                                                ƒê∆°n gi√°</th>
                                                            <th
                                                                style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">
                                                                ƒêVT</th>
                                                            <th
                                                                style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">
                                                            </th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr style="border-bottom: 1px solid #eee; cursor: pointer;"
                                                            onmouseover="this.style.backgroundColor='#f9f9f9'"
                                                            onmouseout="this.style.backgroundColor='transparent'">
                                                            <td style="padding: 8px;">CDHA</td>
                                                            <td style="padding: 8px;">X quang ng·ª±c</td>
                                                            <td style="padding: 8px;">200,000</td>
                                                            <td style="padding: 8px;">l·∫ßn</td>
                                                            <td>
                                                                <button
                                                                    onclick="addServiceToSelected('X quang ng·ª±c', 'l·∫ßn', 200000, 'X Quang')"
                                                                    style="padding: 4px 8px; background-color: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 12px;">Th√™m</button>
                                                            </td>
                                                        </tr>
                                                        <tr style="border-bottom: 1px solid #eee; cursor: pointer;"
                                                            onmouseover="this.style.backgroundColor='#f9f9f9'"
                                                            onmouseout="this.style.backgroundColor='transparent'">
                                                            <td style="padding: 8px;">CDHA</td>
                                                            <td style="padding: 8px;">Si√™u √¢m b·ª•ng</td>
                                                            <td style="padding: 8px;">150,000</td>
                                                            <td style="padding: 8px;">l·∫ßn</td>
                                                            <td>
                                                                <button
                                                                    onclick="addServiceToSelected('Si√™u √¢m b·ª•ng', 'l·∫ßn', 150000, 'Si√™u √Çm')"
                                                                    style="padding: 4px 8px; background-color: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 12px;">Th√™m</button>
                                                            </td>
                                                        </tr>
                                                        <tr style="border-bottom: 1px solid #eee; cursor: pointer;"
                                                            onmouseover="this.style.backgroundColor='#f9f9f9'"
                                                            onmouseout="this.style.backgroundColor='transparent'">
                                                            <td style="padding: 8px;">X√©t nghi·ªám</td>
                                                            <td style="padding: 8px;">X√©t nghi·ªám m√°u attraverso</td>
                                                            <td style="padding: 8px;">80,000</td>
                                                            <td style="padding: 8px;">l·∫ßn</td>
                                                            <td>
                                                                <button
                                                                    onclick="addServiceToSelected('Si√™u √¢m b·ª•ng', 'l·∫ßn', 150000, 'Si√™u √Çm')"
                                                                    style="padding: 4px 8px; background-color: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 12px;">Th√™m</button>
                                                            </td>
                                                        </tr>
                                                        <tr style="border-bottom: 1px solid #eee; cursor: pointer;"
                                                            onmouseover="this.style.backgroundColor='#f9f9f9'"
                                                            onmouseout="this.style.backgroundColor='transparent'">
                                                            <td style="padding: 8px;">X√©t nghi·ªám</td>
                                                            <td style="padding: 8px;">X√©t nghi·ªám huy·∫øt sugar</td>
                                                            <td style="padding: 8px;">60,000</td>
                                                            <td style="padding: 8px;">l·∫ßn</td>
                                                            <td>
                                                                <button
                                                                    onclick="addServiceToSelected('Si√™u √¢m b·ª•ng', 'l·∫ßn', 150000, 'Si√™u √Çm')"
                                                                    style="padding: 4px 8px; background-color: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 12px;">Th√™m</button>
                                                            </td>
                                                        </tr>
                                                        <tr style="border-bottom: 1px solid #eee; cursor: pointer;"
                                                            onmouseover="this.style.backgroundColor='#f9f9f9'"
                                                            onmouseout="this.style.backgroundColor='transparent'">
                                                            <td style="padding: 8px;">CDHA</td>
                                                            <td style="padding: 8px;">X quantity</td>
                                                            <td style="padding: 8px;">180,000</td>
                                                            <td style="padding: 8px;">l·∫ßn</td>
                                                            <td>
                                                                <button
                                                                    onclick="addServiceToSelected('Si√™u √¢m b·ª•ng', 'l·∫ßn', 150000, 'Si√™u √Çm')"
                                                                    style="padding: 4px 8px; background-color: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 12px;">Th√™m</button>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Right side: Details and actions -->
                                    <div style="width: 50%; display: flex; flex-direction: column; height: 100%;">
                                        <!-- Part 1: Selected services (scrollable) -->
                                        <div style="flex: 1; overflow-y: auto; padding: 15px;">
                                            <h4 style="margin-top: 0; margin-bottom: 15px;">D·ªãch v·ª• ƒë√£ ch·ªçn</h4>
                                            <!-- N·ªôi dung nh√≥m d·ªãch v·ª• -->
                                            <div id="selected-services-container">
                                                <!-- B·∫£ng hi·ªÉn th·ªã khi ch∆∞a ch·ªçn d·ªãch v·ª• -->
                                                <div style="border: 1px solid #ddd; border-radius: 4px; margin-bottom: 15px;">
                                                    <table style="width: 100%; border-collapse: collapse; font-size: 12px;">
                                                        <thead>
                                                            <tr style="background-color: #f5f5f5;">
                                                                <th
                                                                    style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">
                                                                    STT</th>
                                                                <th
                                                                    style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">
                                                                    T√™n d·ªãch v·ª•</th>
                                                                <th
                                                                    style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">
                                                                    S·ªë l∆∞·ª£ng</th>
                                                                <th
                                                                    style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">
                                                                    ƒê∆°n gi√°</th>
                                                                <th
                                                                    style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">
                                                                    Th√†nh ti·ªÅn</th>
                                                                <th
                                                                    style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">
                                                                    Thao t√°c</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <!-- D√≤ng tr·ªëng ban ƒë·∫ßu -->
                                                            <tr id="empty-service-row">
                                                                <td colspan="6"
                                                                    style="text-align: center; padding: 15px; color: #999; font-style: italic;">
                                                                    Ch∆∞a ch·ªçn d·ªãch v·ª• n√†o</td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Part 2: Footer actions fixed at the bottom -->
                                        <div class="footer-actions"
                                            style="background-color: white; border-top: 1px solid #ddd; padding: 10px 15px; display: flex; gap: 10px; justify-content: flex-end;">
                                            <button onclick="closePrescriptionPopup()" class="btn"
                                                style="padding: 8px 16px; font-size: 12px;">H·ªßy</button>
                                            <button class="btn primary" style="padding: 8px 16px; font-size: 12px;">L∆∞u ch·ªâ
                                                ƒë·ªãnh</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <script>
                            function openAddPrescriptionPopup() {
                                document.getElementById('prescriptionPopup').style.display = 'flex';
                            }

                            function closePrescriptionPopup() {
                                document.getElementById('prescriptionPopup').style.display = 'none';
                            }

                            // Medicine Popup Functions
                            function openMedicinePopup() {
                                document.getElementById('medicinePopup').style.display = 'flex';
                            }

                            function closeMedicinePopup() {
                                document.getElementById('medicinePopup').style.display = 'none';
                            }

                            function addMedicineToSelected(medicineName, unit, price) {
                                const tbody = document.getElementById('selectedMedicinesBody');

                                // Check if the table is empty (contains only the placeholder row)
                                if (tbody.querySelector('td[colspan="9"]')) {
                                    tbody.innerHTML = '';
                                }

                                // Get current row count for STT
                                const rowCount = tbody.rows.length;

                                // Create new row
                                const row = tbody.insertRow();
                                row.setAttribute('data-medicine', medicineName);
                                row.setAttribute('data-price', price);
                                row.setAttribute('data-unit', unit);

                                // STT
                                const sttCell = row.insertCell();
                                sttCell.textContent = rowCount + 1;
                                sttCell.style.padding = '10px';
                                sttCell.style.borderBottom = '1px solid #eee';

                                // T√™n thu·ªëc
                                const nameCell = row.insertCell();
                                nameCell.textContent = medicineName;
                                nameCell.style.padding = '10px';
                                nameCell.style.borderBottom = '1px solid #eee';

                                // Li·ªÅu d√πng
                                const dosageCell = row.insertCell();
                                dosageCell.style.padding = '10px';
                                dosageCell.style.borderBottom = '1px solid #eee';
                                const dosageInput = document.createElement('input');
                                dosageInput.type = 'text';
                                dosageInput.placeholder = 'VD: 1 vi√™n x 3 l·∫ßn/ng√†y';
                                dosageInput.style.width = '100%';
                                dosageInput.style.padding = '4px';
                                dosageInput.style.border = '1px solid #ddd';
                                dosageInput.style.borderRadius = '4px';
                                dosageInput.style.fontSize = '12px';
                                dosageCell.appendChild(dosageInput);

                                // S·ªë l∆∞·ª£ng
                                const quantityCell = row.insertCell();
                                quantityCell.style.padding = '10px';
                                quantityCell.style.borderBottom = '1px solid #eee';
                                const quantityInput = document.createElement('input');
                                quantityInput.type = 'number';
                                quantityInput.value = 1;
                                quantityInput.min = 1;
                                quantityInput.style.width = '60px';
                                quantityInput.style.padding = '4px';
                                quantityInput.style.border = '1px solid #ddd';
                                quantityInput.style.borderRadius = '4px';
                                quantityInput.style.fontSize = '12px';
                                quantityInput.onchange = function () {
                                    updateMedicineTotal(row);
                                };
                                quantityCell.appendChild(quantityInput);

                                // ƒê∆°n v·ªã
                                const unitCell = row.insertCell();
                                unitCell.textContent = unit;
                                unitCell.style.padding = '10px';
                                unitCell.style.borderBottom = '1px solid #eee';

                                // ƒê∆°n gi√°
                                const priceCell = row.insertCell();
                                priceCell.textContent = formatCurrency(price);
                                priceCell.style.padding = '10px';
                                priceCell.style.borderBottom = '1px solid #eee';
                                priceCell.style.textAlign = 'right';

                                // Th√†nh ti·ªÅn
                                const totalCell = row.insertCell();
                                totalCell.style.padding = '10px';
                                totalCell.style.borderBottom = '1px solid #eee';
                                totalCell.style.textAlign = 'right';
                                totalCell.setAttribute('class', 'medicine-total');
                                totalCell.textContent = formatCurrency(price);

                                // Ghi ch√∫
                                const noteCell = row.insertCell();
                                noteCell.style.padding = '10px';
                                noteCell.style.borderBottom = '1px solid #eee';
                                const noteInput = document.createElement('input');
                                noteInput.type = 'text';
                                noteInput.placeholder = 'C√°ch d√πng';
                                noteInput.style.width = '100%';
                                noteInput.style.padding = '4px';
                                noteInput.style.border = '1px solid #ddd';
                                noteInput.style.borderRadius = '4px';
                                noteInput.style.fontSize = '12px';
                                noteCell.appendChild(noteInput);

                                // Thao t√°c
                                const actionCell = row.insertCell();
                                actionCell.style.padding = '10px';
                                actionCell.style.borderBottom = '1px solid #eee';
                                const removeBtn = document.createElement('button');
                                removeBtn.className = 'btn';
                                removeBtn.textContent = 'X√≥a';
                                removeBtn.style.padding = '4px 8px';
                                removeBtn.style.backgroundColor = '#f44336';
                                removeBtn.style.color = 'white';
                                removeBtn.style.border = '1px solid #f44336';
                                removeBtn.style.fontSize = '11px';
                                removeBtn.onclick = function () {
                                    removeSelectedMedicine(row);
                                };
                                actionCell.appendChild(removeBtn);
                            }

                            function removeSelectedMedicine(row) {
                                const tbody = document.getElementById('selectedMedicinesBody');
                                tbody.removeChild(row);

                                // Update STT numbers
                                updateMedicineSTTNumbers();

                                // Check if table is now empty
                                if (tbody.rows.length === 0) {
                                    const emptyRow = tbody.insertRow();
                                    const emptyCell = emptyRow.insertCell();
                                    emptyCell.colSpan = '9';
                                    emptyCell.style.textAlign = 'center';
                                    emptyCell.style.padding = '15px';
                                    emptyCell.style.color = '#999';
                                    emptyCell.style.fontStyle = 'italic';
                                    emptyCell.textContent = 'Ch∆∞a ch·ªçn thu·ªëc n√†o';
                                }
                            }

                            function updateMedicineSTTNumbers() {
                                const tbody = document.getElementById('selectedMedicinesBody');
                                for (let i = 0; i < tbody.rows.length; i++) {
                                    tbody.rows[i].cells[0].textContent = i + 1;
                                }
                            }

                            function updateMedicineTotal(row) {
                                const price = parseFloat(row.getAttribute('data-price'));
                                const quantityInput = row.querySelector('input[type="number"]');
                                const quantity = parseInt(quantityInput.value) || 1;
                                const total = price * quantity;

                                const totalCell = row.querySelector('.medicine-total');
                                totalCell.textContent = formatCurrency(total);
                            }

                            function saveMedicinePrescription() {
                                const tbody = document.getElementById('selectedMedicinesBody');
                                const medicines = [];

                                if (tbody.rows.length === 0 || tbody.querySelector('td[colspan="9"]')) {
                                    alert('Vui l√≤ng ch·ªçn √≠t nh·∫•t m·ªôt thu·ªëc!');
                                    return;
                                }

                                // Collect all selected medicines with their details
                                for (let i = 0; i < tbody.rows.length; i++) {
                                    const row = tbody.rows[i];
                                    const medicine = {
                                        name: row.getAttribute('data-medicine'),
                                        dosage: row.cells[2].querySelector('input').value,
                                        quantity: row.cells[3].querySelector('input').value,
                                        unit: row.getAttribute('data-unit'),
                                        price: row.getAttribute('data-price'),
                                        note: row.cells[7].querySelector('input').value
                                    };
                                    medicines.push(medicine);
                                }

                                // In a real application, this would send data to server
                                console.log('Saving medicine prescription:', medicines);

                                // Show success message and close popup
                                alert('‚úÖ ƒê∆°n thu·ªëc ƒë√£ ƒë∆∞·ª£c l∆∞u th√†nh c√¥ng!');
                                closeMedicinePopup();

                                // Here you would typically update the prescription list in the UI
                            }

                            // Format currency function (reuse from existing code)
                            function formatCurrency(value) {
                                return new Intl.NumberFormat('vi-VN', {
                                    style: 'currency',
                                    currency: 'VND'
                                }).format(value);
                            }
                        </script>

                        <!-- Result Popup -->
                        <div id="resultPopup"
                            style="display: none; position: fixed; top: 5%; left: 5%; width: 90%; height: 90%; background-color: white; border-radius: 8px; box-shadow: 0 10px 30px rgba(0,0,0,0.3); z-index: 1000;">
                            <div
                                style="padding: 15px; border-bottom: 1px solid #ddd; display: flex; justify-content: space-between; align-items: center;">
                                <h3 style="margin: 0;" id="popupTitle">K·∫øt qu·∫£: X√©t nghi·ªám m√°u</h3>
                                <button onclick="closeResultPopup()"
                                    style="background: none; border: none; font-size: 24px; cursor: pointer;">&times;</button>
                            </div>
                            <div style="display: flex; height: calc(100% - 60px);">
                                <!-- Left Main Area - 70% width -->
                                <div style="flex: 0 0 70%; padding: 15px; border-right: 1px solid #ddd; overflow-y: auto;">
                                    <div id="resultMainContent"
                                        style="text-align: center; min-height: 400px; display: flex; justify-content: center; align-items: center;">
                                        <p>Ch·ªçn m·ªôt k·∫øt qu·∫£ t·ª´ danh s√°ch b√™n ph·∫£i ƒë·ªÉ xem chi ti·∫øt</p>
                                    </div>
                                </div>
                                <!-- Right Sidebar - 30% width -->
                                <div style="flex: 0 0 30%; background-color: #f8f9fa; overflow-y: auto;">
                                    <h4 style="padding: 15px; margin: 0; border-bottom: 1px solid #ddd;">Danh s√°ch k·∫øt qu·∫£
                                    </h4>
                                    <div id="resultList" style="padding: 10px;">
                                        <!-- Result items will be added here dynamically -->
                                        <div class="result-item"
                                            onclick="loadResultItem('K·∫øt qu·∫£ ch√≠nh', 'X√©t nghi·ªám m√°u ho√†n ch·ªânh')"
                                            style="padding: 10px; margin-bottom: 8px; background-color: white; border-radius: 4px; cursor: pointer; border: 1px solid #ddd; transition: all 0.2s;">
                                            <div style="font-weight: bold;">K·∫øt qu·∫£ ch√≠nh</div>
                                            <div style="font-size: 12px; color: #666;">X√©t nghi·ªám m√°u ho√†n ch·ªânh</div>
                                            <div style="font-size: 12px; color: #2196F3;">20/11/2023</div>
                                        </div>
                                        <div class="result-item"
                                            onclick="loadResultItem('B√°o c√°o ti·ªÉu c·∫ßu', 'Chi ti·∫øt ti·ªÉu c·∫ßu trong m√°u')"
                                            style="padding: 10px; margin-bottom: 8px; background-color: white; border-radius: 4px; cursor: pointer; border: 1px solid #ddd; transition: all 0.2s;">
                                            <div style="font-weight: bold;">B√°o c√°o ti·ªÉu c·∫ßu</div>
                                            <div style="font-size: 12px; color: #666;">Chi ti·∫øt ti·ªÉu c·∫ßu trong m√°u</div>
                                            <div style="font-size: 12px; color: #2196F3;">20/11/2023</div>
                                        </div>
                                        <div class="result-item"
                                            onclick="loadResultItem('B√°o c√°o h√≥a sinh', 'K·∫øt qu·∫£ h√≥a sinh m√°u')"
                                            style="padding: 10px; margin-bottom: 8px; background-color: white; border-radius: 4px; cursor: pointer; border: 1px solid #ddd; transition: all 0.2s;">
                                            <div style="font-weight: bold;">B√°o c√°o h√≥a sinh</div>
                                            <div style="font-size: 12px; color: #666;">K·∫øt qu·∫£ h√≥a sinh m√°u</div>
                                            <div style="font-size: 12px; color: #2196F3;">20/11/2023</div>
                                        </div>
                                    </div>
                                    <div style="text-align: center; padding: 15px; border-top: 1px solid #ddd; background-color: #f8f9fa;">
                                        <button onclick="openFileUploadPopup()"
                                            style="padding: 8px 16px; background-color: #4299E1; color: white; border: none; border-radius: 4px; cursor: pointer;">Th√™m file ƒë√≠nh k√®m</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Medicine Prescription Popup -->
                        <div id="medicinePopup"
                            style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 90%; height: 90%; background: white; border-radius: 8px; box-shadow: 0 5px 25px rgba(0,0,0,0.3); z-index: 1000; overflow: hidden; flex-direction: column;">
                            <div
                                style="display: flex; justify-content: space-between; align-items: center; padding: 15px 20px; border-bottom: 1px solid #ddd;">
                                <h3 style="margin: 0;">Th√™m ƒë∆°n thu·ªëc</h3>
                                <button onclick="closeMedicinePopup()"
                                    style="background: none; border: none; font-size: 24px; cursor: pointer;">&times;</button>
                            </div>

                            <div style="display: flex; height: calc(100% - 120px);">
                                <!-- Left Medicine List -->
                                <div
                                    style="flex: 0 0 50%; border-right: 1px solid #ddd; overflow: hidden; display: flex; flex-direction: column;">
                                    <div style="padding: 15px; background-color: #f8f9fa; border-bottom: 1px solid #ddd;">
                                        <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                                            <input type="text" placeholder="T√¨m ki·∫øm thu·ªëc..."
                                                style="flex: 1; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                                            <button
                                                style="padding: 8px 15px; background-color: #2196F3; color: white; border: none; border-radius: 4px; cursor: pointer;">T√¨m</button>
                                        </div>
                                    </div>
                                    <div style="flex: 1; overflow-y: auto;">
                                        <table style="width: 100%; border-collapse: collapse; font-size: 12px;">
                                            <thead style="background-color: #f8f9fa; position: sticky; top: 0; z-index: 10;">
                                                <tr>
                                                    <th style="padding: 10px; text-align: left; border-bottom: 1px solid #ddd;">
                                                        STT</th>
                                                    <th style="padding: 10px; text-align: left; border-bottom: 1px solid #ddd;">
                                                        T√™n thu·ªëc</th>
                                                    <th style="padding: 10px; text-align: left; border-bottom: 1px solid #ddd;">
                                                        ƒê∆°n v·ªã</th>
                                                    <th
                                                        style="padding: 10px; text-align: right; border-bottom: 1px solid #ddd;">
                                                        Gi√°</th>
                                                    <th
                                                        style="padding: 10px; text-align: center; border-bottom: 1px solid #ddd;">
                                                        Thao t√°c</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td style="padding: 10px; border-bottom: 1px solid #eee;">1</td>
                                                    <td style="padding: 10px; border-bottom: 1px solid #eee;">Paracetamol
                                                        500mg<br><span
                                                            style="font-style: italic; color: #666; font-size: 11px;">U·ªëng
                                                            sau b·ªØa ƒÉn</span></td>
                                                    <td style="padding: 10px; border-bottom: 1px solid #eee;">vi√™n</td>
                                                    <td
                                                        style="padding: 10px; text-align: right; border-bottom: 1px solid #eee;">
                                                        5,000</td>
                                                    <td
                                                        style="padding: 10px; text-align: center; border-bottom: 1px solid #eee;">
                                                        <button
                                                            onclick="addMedicineToSelected('Paracetamol 500mg', 'vi√™n', 5000)"
                                                            style="padding: 4px 8px; background-color: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 12px;">Th√™m</button>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td style="padding: 10px; border-bottom: 1px solid #eee;">2</td>
                                                    <td style="padding: 10px; border-bottom: 1px solid #eee;">Amoxicillin
                                                        500mg<br><span
                                                            style="font-style: italic; color: #666; font-size: 11px;">U·ªëng
                                                            tr∆∞·ªõc b·ªØa ƒÉn</span></td>
                                                    <td style="padding: 10px; border-bottom: 1px solid #eee;">vi√™n</td>
                                                    <td
                                                        style="padding: 10px; text-align: right; border-bottom: 1px solid #eee;">
                                                        15,000</td>
                                                    <td
                                                        style="padding: 10px; text-align: center; border-bottom: 1px solid #eee;">
                                                        <button
                                                            onclick="addMedicineToSelected('Amoxicillin 500mg', 'vi√™n', 15000)"
                                                            style="padding: 4px 8px; background-color: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 12px;">Th√™m</button>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td style="padding: 10px; border-bottom: 1px solid #eee;">3</td>
                                                    <td style="padding: 10px; border-bottom: 1px solid #eee;">Ibuprofen
                                                        400mg<br><span
                                                            style="font-style: italic; color: #666; font-size: 11px;">U·ªëng
                                                            sau b·ªØa ƒÉn</span></td>
                                                    <td style="padding: 10px; border-bottom: 1px solid #eee;">vi√™n</td>
                                                    <td
                                                        style="padding: 10px; text-align: right; border-bottom: 1px solid #eee;">
                                                        10,000</td>
                                                    <td
                                                        style="padding: 10px; text-align: center; border-bottom: 1px solid #eee;">
                                                        <button
                                                            onclick="addMedicineToSelected('Ibuprofen 400mg', 'vi√™n', 10000)"
                                                            style="padding: 4px 8px; background-color: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 12px;">Th√™m</button>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td style="padding: 10px; border-bottom: 1px solid #eee;">4</td>
                                                    <td style="padding: 10px; border-bottom: 1px solid #eee;">Salbutamol
                                                        2mg<br><span
                                                            style="font-style: italic; color: #666; font-size: 11px;">Ng·∫≠m
                                                            d∆∞·ªõi l∆∞·ª°i</span></td>
                                                    <td style="padding: 10px; border-bottom: 1px solid #eee;">vi√™n</td>
                                                    <td
                                                        style="padding: 10px; text-align: right; border-bottom: 1px solid #eee;">
                                                        20,000</td>
                                                    <td
                                                        style="padding: 10px; text-align: center; border-bottom: 1px solid #eee;">
                                                        <button onclick="addMedicineToSelected('Salbutamol 2mg', 'vi√™n', 20000)"
                                                            style="padding: 4px 8px; background-color: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 12px;">Th√™m</button>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td style="padding: 10px; border-bottom: 1px solid #eee;">5</td>
                                                    <td style="padding: 10px; border-bottom: 1px solid #eee;">Omeprazole
                                                        20mg<br><span
                                                            style="font-style: italic; color: #666; font-size: 11px;">U·ªëng
                                                            tr∆∞·ªõc b·ªØa s√°ng</span></td>
                                                    <td style="padding: 10px; border-bottom: 1px solid #eee;">vi√™n</td>
                                                    <td
                                                        style="padding: 10px; text-align: right; border-bottom: 1px solid #eee;">
                                                        25,000</td>
                                                    <td
                                                        style="padding: 10px; text-align: center; border-bottom: 1px solid #eee;">
                                                        <button
                                                            onclick="addMedicineToSelected('Omeprazole 20mg', 'vi√™n', 25000)"
                                                            style="padding: 4px 8px; background-color: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 12px;">Th√™m</button>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>

                                <!-- Right Selected Medicines -->
                                <div style="flex: 0 0 50%; overflow: hidden; display: flex; flex-direction: column;">
                                    <div style="padding: 15px; background-color: #f8f9fa; border-bottom: 1px solid #ddd;">
                                        <h4 style="margin: 0;">Danh s√°ch thu·ªëc ƒë√£ ch·ªçn</h4>
                                    </div>
                                    <div style="flex: 1; overflow-y: auto;">
                                        <table id="selectedMedicinesTable"
                                            style="width: 100%; border-collapse: collapse; font-size: 12px;">
                                            <thead style="background-color: #f8f9fa; position: sticky; top: 0; z-index: 10;">
                                                <tr>
                                                    <th style="padding: 10px; text-align: left; border-bottom: 1px solid #ddd;">
                                                        STT</th>
                                                    <th style="padding: 10px; text-align: left; border-bottom: 1px solid #ddd;">
                                                        T√™n thu·ªëc</th>
                                                    <th style="padding: 10px; text-align: left; border-bottom: 1px solid #ddd;">
                                                        Li·ªÅu l∆∞·ª£ng</th>
                                                    <th
                                                        style="padding: 10px; text-align: center; border-bottom: 1px solid #ddd;">
                                                        S·ªë l∆∞·ª£ng</th>
                                                    <th style="padding: 10px; text-align: left; border-bottom: 1px solid #ddd;">
                                                        ƒê∆°n v·ªã</th>
                                                    <th
                                                        style="padding: 10px; text-align: right; border-bottom: 1px solid #ddd;">
                                                        Gi√°</th>
                                                    <th
                                                        style="padding: 10px; text-align: right; border-bottom: 1px solid #ddd;">
                                                        Th√†nh ti·ªÅn</th>
                                                    <th style="padding: 10px; text-align: left; border-bottom: 1px solid #ddd;">
                                                        C√°ch d√πng</th>
                                                    <th
                                                        style="padding: 10px; text-align: center; border-bottom: 1px solid #ddd;">
                                                        Thao t√°c</th>
                                                </tr>
                                            </thead>
                                            <tbody id="selectedMedicinesBody">
                                                <tr>
                                                    <td colspan="9"
                                                        style="text-align: center; padding: 20px; color: #999; font-style: italic;">
                                                        Ch∆∞a ch·ªçn thu·ªëc n√†o
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>

                                    <div style="padding: 15px; background-color: #f8f9fa; border-top: 1px solid #ddd;">
                                        <div style="display: flex; justify-content: space-between; align-items: center;">
                                            <div style="font-weight: bold;">T·ªïng ti·ªÅn:</div>
                                            <div id="medicineTotalPrice"
                                                style="font-weight: bold; color: #2196F3; font-size: 18px;">0 VNƒê</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div
                                style="display: flex; justify-content: flex-end; gap: 10px; padding: 15px 20px; border-top: 1px solid #ddd;">
                                <button onclick="closeMedicinePopup()"
                                    style="padding: 8px 20px; background-color: #f44336; color: white; border: none; border-radius: 4px; cursor: pointer;">H·ªßy</button>
                                <button onclick="saveMedicinePrescription()"
                                    style="padding: 8px 20px; background-color: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer;">L∆∞u
                                    ƒë∆°n thu·ªëc</button>
                            </div>
                        </div>

                        <!-- Overlay for popup -->
                        <div id="popupOverlay"
                            style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); z-index: 999;">
                        </div>

                        <script>
                            function showResultPopup(title) {
                                document.getElementById('popupTitle').textContent = 'K·∫øt qu·∫£: ' + title;
                                document.getElementById('resultPopup').style.display = 'block';
                                document.getElementById('popupOverlay').style.display = 'block';
                            }

                            function closeResultPopup() {
                                document.getElementById('resultPopup').style.display = 'none';
                                document.getElementById('popupOverlay').style.display = 'none';
                            }

                            function loadResultItem(title, description) {
                                // Simulate loading different content based on selection
                                const mainContent = document.getElementById('resultMainContent');

                                // Clear previous content
                                mainContent.innerHTML = '';

                                // Create new content based on selection
                                const contentDiv = document.createElement('div');
                                contentDiv.style.width = '100%';

                                // Add title
                                const h3 = document.createElement('h3');
                                h3.textContent = title;
                                contentDiv.appendChild(h3);

                                // Add description
                                const p = document.createElement('p');
                                p.textContent = description;
                                contentDiv.appendChild(p);

                                // Simulate adding an image or content
                                if (title.includes('X√©t nghi·ªám')) {
                                    // For blood test results, show a table with data
                                    const table = document.createElement('table');
                                    table.style.width = '100%';
                                    table.style.borderCollapse = 'collapse';
                                    table.style.marginTop = '20px';

                                    const thead = document.createElement('thead');
                                    thead.innerHTML = `
                                            <tr>
                                                <th style="border: 1px solid #ddd; padding: 8px; text-align: left; background-color: #f2f2f2;">Th√¥ng s·ªë</th>
                                                <th style="border: 1px solid #ddd; padding: 8px; text-align: left; background-color: #f2f2f2;">Gi√° tr·ªã</th>
                                                <th style="border: 1px solid #ddd; padding: 8px; text-align: left; background-color: #f2f2f2;">Ph·∫°m vi b√¨nh th∆∞·ªùng</th>
                                                <th style="border: 1px solid #ddd; padding: 8px; text-align: left; background-color: #f2f2f2;">T√¨nh tr·∫°ng</th>
                                            </tr>
                                        `;
                                    table.appendChild(thead);

                                    const tbody = document.createElement('tbody');
                                    tbody.innerHTML = `
                                            <tr>
                                                <td style="border: 1px solid #ddd; padding: 8px;">Hb</td>
                                                <td style="border: 1px solid #ddd; padding: 8px;">14.5 g/dL</td>
                                                <td style="border: 1px solid #ddd; padding: 8px;">12.0-16.0 g/dL</td>
                                                <td style="border: 1px solid #ddd; padding: 8px;"><span style="color: green;">B√¨nh th∆∞·ªùng</span></td>
                                            </tr>
                                            <tr>
                                                <td style="border: 1px solid #ddd; padding: 8px;">HCT</td>
                                                <td style="border: 1px solid #ddd; padding: 8px;">42.3%</td>
                                                <td style="border: 1px solid #ddd; padding: 8px;">36.0-46.0%</td>
                                                <td style="border: 1px solid #ddd; padding: 8px;"><span style="color: green;">B√¨nh th∆∞·ªùng</span></td>
                                            </tr>
                                            <tr>
                                                <td style="border: 1px solid #ddd; padding: 8px;">WBC</td>
                                                <td style="border: 1px solid #ddd; padding: 8px;">5.8 x 10^9/L</td>
                                                <td style="border: 1px solid #ddd; padding: 8px;">4.0-11.0 x 10^9/L</td>
                                                <td style="border: 1px solid #ddd; padding: 8px;"><span style="color: green;">B√¨nh th∆∞·ªùng</span></td>
                                            </tr>
                                            <tr>
                                                <td style="border: 1px solid #ddd; padding: 8px;">PLT</td>
                                                <td style="border: 1px solid #ddd; padding: 8px;">225 x 10^9/L</td>
                                                <td style="border: 1px solid #ddd; padding: 8px;">150-450 x 10^9/L</td>
                                                <td style="border: 1px solid #ddd; padding: 8px;"><span style="color: green;">B√¨nh th∆∞·ªùng</span></td>
                                            </tr>
                                        `;
                                    table.appendChild(tbody);
                                    contentDiv.appendChild(table);
                                } else {
                                    // For other results, show a placeholder image
                                    const img = document.createElement('img');
                                    img.src = 'https://via.placeholder.com/600x400?text=' + encodeURIComponent(title);
                                    img.alt = title;
                                    img.style.maxWidth = '100%';
                                    img.style.maxHeight = '500px';
                                    img.style.marginTop = '20px';
                                    contentDiv.appendChild(img);
                                }

                                mainContent.appendChild(contentDiv);

                                // Highlight selected item
                                const items = document.querySelectorAll('.result-item');
                                items.forEach(item => {
                                    item.style.backgroundColor = '#f0f0f0';
                                    item.style.borderColor = '#ddd';
                                });
                                event.currentTarget.style.backgroundColor = '#e3f2fd';
                                event.currentTarget.style.borderColor = '#2196F3';
                            }

                            // Add hover effects to result items
                            document.addEventListener('DOMContentLoaded', function () {
                                const items = document.querySelectorAll('.result-item');
                                items.forEach(item => {
                                    item.addEventListener('mouseover', function () {
                                        if (this.style.backgroundColor !== '#e3f2fd') {
                                            this.style.backgroundColor = '#f0f0f0';
                                        }
                                    });
                                    item.addEventListener('mouseout', function () {
                                        if (this.style.backgroundColor !== '#e3f2fd') {
                                            this.style.backgroundColor = 'white';
                                        }
                                    });
                                });
                            });
                        </script>
                    </div>
                    <div class="card-body" style="flex: 1; overflow-y: auto; padding: 8px;">
                        <div class="diagnosis-list">
                            <div class="diagnosis-item">
                                <div class="diagnosis-info">
                                    <h4>X√©t nghi·ªám m√°u</h4>
                                        <p>Ng√†y ch·ªâ ƒë·ªãnh: 20/11/2023</p>
                                        <p>Lo·∫°i: X√©t ·∫£nh</p>
                                        <span class="status-badge"
                                            style="display: inline-block; padding: 2px 6px; background-color: #10b981; color: white; border-radius: 4px; font-size: 10px; margin-top: 4px;">Ho√†n
                                            th√†nh</span>
                                </div>
                                <div style="display: flex; flex-direction: column; gap: 4px;">
                                    <button class="btn"
                                        style="font-size: 11px; padding: 4px 8px; background-color: #2196F3; color: white; border: 1px solid #2196F3;"
                                        onclick="showResultPopup('X√©t nghi·ªám m√°u')">Xem</button>
                                </div>
                            </div>
                            <div class="diagnosis-item">
                                <div class="diagnosis-info">
                                    <h4>X quang ng·ª±c</h4>
                                    <p>Lo·∫°i: X√©t ·∫£nh</p>
                                    <p>Ng√†y ch·ªâ ƒë·ªãnh: 20/11/2023</p>
                                    <span class="status-badge"
                                        style="display: inline-block; padding: 2px 6px; background-color: #f59e0b; color: white; border-radius: 4px; font-size: 10px; margin-top: 4px;">ƒêang
                                        th·ª±c hi·ªán</span>
                                </div>
                                <div style="display: flex; flex-direction: column; gap: 4px;">
                                </div>
                            </div>
                            <div class="diagnosis-item">
                                <div class="diagnosis-info">
                                    <h4>X quang vai</h4>
                                    <p>Lo·∫°i: X√©t ·∫£nh</p>
                                    <p>Ng√†y ch·ªâ ƒë·ªãnh: 20/11/2023</p>
                                    <span class="status-badge"
                                        style="display: inline-block; padding: 2px 6px; background-color: #f8edda; color: rgb(4, 3, 3); border-radius: 4px; font-size: 10px; margin-top: 4px;">Ch∆∞a
                                        th·ª±c hi·ªán</span>
                                </div>
                                <div style="display: flex; flex-direction: column; gap: 4px;">
                                    <button class="btn edit"
                                        style="font-size: 11px; padding: 4px 8px; background-color: #4CAF50; color: white; border: 1px solid #4CAF50;">S·ª≠a</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Ph·∫ßn 2: Danh s√°ch ƒë∆°n thu·ªëc - C·ªë ƒë·ªãnh 33% chi·ªÅu cao -->
                <div class="card"
                    style="margin-bottom: 0; margin-top: 1px; flex: 1; min-height: 0; display: flex; flex-direction: column; max-height: 200px;">
                    <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
                        <span>ƒê∆°n thu·ªëc</span>
                        <button class="btn primary" style="font-size: 11px; padding: 4px 8px;"
                            onclick="openMedicinePopup()">Th√™m ƒë∆°n thu·ªëc</button>
                    </div>
                    <div class="card-body" style="flex: 1; overflow-y: auto; padding: 8px;">
                        <div class="prescription-list">
                            <div class="prescription-item">
                                <div class="prescription-info">
                                    <h4>Ch·∫©n ƒëo√°n: Vi√™m ph·ªïi c·∫•p</h4>
                                    <p>Ng√†y k√™: 20/11/2023</p>
                                </div>
                                <button class="btn"
                                    style="font-size: 11px; padding: 4px 8px; background-color: #2196F3; color: white; border: 1px solid #2196F3;"
                                    onclick="showResultPopup('X√©t nghi·ªám m√°u')">Xem</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="footer-actions">
                    <button class="btn primary" onclick="resetForm()">B·ªánh √°n ƒëi·ªán t·ª≠</button>
                </div>
            </div>
        </div>
    </div>
    



    <!-- ÂºπÂá∫Á™óÂè£ÔºöK·∫øt th√∫c kh√°m b·ªánh -->
    <div id="endExaminationPopup"
        style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); z-index: 1000; justify-content: center; align-items: center;">
        <div
            style="background-color: white; border-radius: 8px; width: 500px; max-height: 80vh; overflow-y: auto; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
            <div style="padding: 20px; border-bottom: 1px solid #eee;">
                <h3 style="margin: 0;">K·∫øt th√∫c kh√°m b·ªánh</h3>
            </div>
            <div style="padding: 20px;">
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: bold;">Lo·∫°i k·∫øt th√∫c kh√°m:</label>
                    <select id="endExaminationType"
                        style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;"
                        onchange="showEndExaminationForm()">
                        <option value="">-- Ch·ªçn lo·∫°i --</option>
                        <option value="cho-ve">Cho v·ªÅ</option>
                        <option value="hen-kham-lai">H·∫πn kh√°m l·∫°i</option>
                        <option value="nhap-vien">Nh·∫≠p vi·ªán</option>
                        <option value="chuyen-vien">Chuy·ªÉn vi·ªán</option>
                        <option value="khong-kham">Kh√¥ng kh√°m</option>
                    </select>
                </div>

                <!-- Form d√†nh cho t·ª´ng lo·∫°i -->
                <div id="cho-ve-form" style="display: none;">
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 5px;">H∆∞·ªõng d·∫´n v·ªÅ nh√†:</label>
                        <textarea
                            style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; min-height: 80px;"></textarea>
                    </div>
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 5px;">Thu·ªëc theo d√µi:</label>
                        <textarea
                            style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; min-height: 60px;"></textarea>
                    </div>
                </div>

                <div id="hen-kham-lai-form" style="display: none;">
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 5px;">Ng√†y h·∫πn kh√°m l·∫°i:</label>
                        <input type="date"
                            style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                    </div>
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 5px;">L√Ω do h·∫πn kh√°m:</label>
                        <textarea
                            style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; min-height: 60px;"></textarea>
                    </div>
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 5px;">B·ªô ph·∫≠n chuy√™n khoa:</label>
                        <input type="text"
                            style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                    </div>
                </div>

                <div id="nhap-vien-form" style="display: none;">
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 5px;">Khoa nh·∫≠p vi·ªán:</label>
                        <select style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                            <option value="">-- Ch·ªçn khoa --</option>
                            <option value="noi-khoa">N·ªôi khoa</option>
                            <option value="ngoai-khoa">Ngo·∫°i khoa</option>
                            <option value="phau-thuat">Ph·∫´u thu·∫≠t</option>
                            <option value="sinh-hoc">Sinh h·ªçc</option>
                            <option value="khac">Kh√°c</option>
                        </select>
                    </div>
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 5px;">L√Ω do nh·∫≠p vi·ªán:</label>
                        <textarea
                            style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; min-height: 80px;"></textarea>
                    </div>
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 5px;">Ng√†y d·ª± ki·∫øn nh·∫≠p vi·ªán:</label>
                        <input type="date"
                            style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                    </div>
                </div>

                <div id="chuyen-vien-form" style="display: none;">
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 5px;">B·ªánh vi·ªán chuy·ªÉn t·ªõi:</label>
                        <input type="text"
                            style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                    </div>
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 5px;">Khoa chuy√™n m√¥n:</label>
                        <input type="text"
                            style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                    </div>
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 5px;">L√Ω do chuy·ªÉn vi·ªán:</label>
                        <textarea
                            style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; min-height: 80px;"></textarea>
                    </div>
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 5px;">T√¨nh tr·∫°ng b·ªánh nh√¢n:</label>
                        <select style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                            <option value="">-- Ch·ªçn t√¨nh tr·∫°ng --</option>
                            <option value="kha">Kh·∫£</option>
                            <option value="trung-binh">Trung b√¨nh</option>
                            <option value="y-te">Y t·∫ø</option>
                            <option value="nguy-khi">Nguy khi</option>
                        </select>
                    </div>
                </div>

                <div id="khong-kham-form" style="display: none;">
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 5px;">L√Ω do kh√¥ng kh√°m:</label>
                        <textarea
                            style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; min-height: 100px;"></textarea>
                    </div>
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 5px;">H∆∞·ªõng d·∫´n sau:</label>
                        <textarea
                            style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; min-height: 60px;"></textarea>
                    </div>
                </div>
            </div>
            <div
                style="padding: 15px 20px; border-top: 1px solid #eee; display: flex; justify-content: flex-end; gap: 10px;">
                <button class="btn" onclick="closeEndExaminationPopup()">H·ªßy</button>
                <button class="btn primary" onclick="saveEndExamination()">L∆∞u</button>
            </div>
        </div>
    </div>
    </div>

    <script>
        // Hi·ªÉn th·ªã popup k·∫øt th√∫c kh√°m
        function endExamination() {
            document.getElementById('endExaminationPopup').style.display = 'flex';
        }

        // ƒê√≥ng popup
        function closeEndExaminationPopup() {
            document.getElementById('endExaminationPopup').style.display = 'none';
            document.getElementById('endExaminationType').value = '';
            showEndExaminationForm(); // Reset form display
        }

        // Hi·ªÉn th·ªã form t∆∞∆°ng ·ª©ng v·ªõi lo·∫°i ch·ªçn
        function showEndExaminationForm() {
            const type = document.getElementById('endExaminationType').value;

            // ·∫®n t·∫•t c·∫£ c√°c form
            document.getElementById('cho-ve-form').style.display = 'none';
            document.getElementById('hen-kham-lai-form').style.display = 'none';
            document.getElementById('nhap-vien-form').style.display = 'none';
            document.getElementById('chuyen-vien-form').style.display = 'none';
            document.getElementById('khong-kham-form').style.display = 'none';

            // Hi·ªÉn th·ªã form t∆∞∆°ng ·ª©ng
            if (type) {
                document.getElementById(type + '-form').style.display = 'block';
            }
        }

        // L∆∞u th√¥ng tin k·∫øt th√∫c kh√°m
        function saveEndExamination() {
            const type = document.getElementById('endExaminationType').value;

            if (!type) {
                alert('Vui l√≤ng ch·ªçn lo·∫°i k·∫øt th√∫c kh√°m');
                return;
            }

            // Th·ª±c hi·ªán l∆∞u d·ªØ li·ªáu (gi·∫£ l·∫≠p)
            alert('‚úÖ Th√¥ng tin k·∫øt th√∫c kh√°m ƒë√£ ƒë∆∞·ª£c l∆∞u!');

            // ƒê√≥ng popup
            closeEndExaminationPopup();

            // Th·ª±c hi·ªán c√°c h√†nh ƒë·ªông ti·∫øp theo nh∆∞ chuy·ªÉn sang b·ªánh nh√¢n kh√°c
            // (c√≥ th·ªÉ g·ªçi h√†m t∆∞∆°ng t·ª± nh∆∞ trong yhct.html)
        }
    </script>

    </div>

    <script>
        // Ch·ª©c nƒÉng ch·ªçn b·ªánh nh√¢n trong danh s√°ch
        document.querySelectorAll('.patient-item').forEach(item => {
            item.addEventListener('click', function () {
                // Lo·∫°i b·ªè l·ªõp active t·ª´ t·∫•t c·∫£ c√°c items
                document.querySelectorAll('.patient-item').forEach(p => p.classList.remove('active'));
                // Th√™m l·ªõp active cho item ƒë∆∞·ª£c ch·ªçn
                this.classList.add('active');
                // ·ªû ƒë√¢y c√≥ th·ªÉ load th√¥ng tin b·ªánh nh√¢n t∆∞∆°ng ·ª©ng
                loadPatientInfo(this.querySelector('.patient-info h3').textContent);
            });
        });

        // T·∫£i th√¥ng tin b·ªánh nh√¢n
        function loadPatientInfo(patientName) {
            // Trong th·ª±c t·∫ø, ƒë√¢y s·∫Ω l√† m·ªôt y√™u c·∫ßu AJAX ƒë·ªÉ l·∫•y d·ªØ li·ªáu b·ªánh nh√¢n
            console.log('Loading information for patient:', patientName);
            // C·∫≠p nh·∫≠t t√™n b·ªánh nh√¢n trong ph·∫ßn chi ti·∫øt
            document.querySelector('.detail-value').textContent = patientName;
        }

        // L∆∞u k·∫øt qu·∫£ kh√°m b·ªánh
        function saveExamination() {
            alert('‚úÖ K·∫øt qu·∫£ kh√°m b·ªánh ƒë√£ ƒë∆∞·ª£c l∆∞u th√†nh c√¥ng!');
        }

        // T·∫°o v√† in ƒë∆°n thu·ªëc
        function generatePrescription() {
            alert('‚úÖ ƒê∆°n thu·ªëc ƒë√£ ƒë∆∞·ª£c t·∫°o. ƒêang chu·∫©n b·ªã in...');
            // Trong th·ª±c t·∫ø, ƒë√¢y s·∫Ω m·ªü m·ªôt c·ª≠a s·ªï in ho·∫∑c t·∫£i t·ªáp PDF
        }

        // L√†m l·∫°i phi·∫øu kh√°m
        function resetForm() {
            if (confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën l√†m l·∫°i phi·∫øu kh√°m? T·∫•t c·∫£ d·ªØ li·ªáu ch∆∞a l∆∞u s·∫Ω b·ªã m·∫•t.')) {
                // X√≥a t·∫•t c·∫£ d·ªØ li·ªáu trong form
                document.querySelectorAll('input, textarea').forEach(el => el.value = '');
                // X√≥a danh s√°ch ch·ªâ ƒë·ªãnh v√† thu·ªëc
                document.querySelectorAll('.diagnosis-list, .prescription-list').forEach(list => {
                    list.innerHTML = '';
                });
            }
        }

        // Th√™m s·ª± ki·ªán cho n√∫t Th√™m ch·ªâ ƒë·ªãnh
        document.querySelector('.btn.primary').addEventListener('click', function () {
            // Trong th·ª±c t·∫ø, ƒë√¢y s·∫Ω x·ª≠ l√Ω vi·ªác th√™m ch·ªâ ƒë·ªãnh v√†o danh s√°ch
            console.log('Adding new diagnosis...');
        });

        // Th√™m d·ªãch v·ª• v√†o danh s√°ch d·ªãch v·ª• ƒë√£ ch·ªçn
        function addServiceToSelected(serviceName, unit, price, serviceGroup = 'Chung') {
            // L·∫•y th√¥ng tin d·ªãch v·ª•
            const serviceInfo = {
                name: serviceName || "X√©t nghi·ªám huy·∫øt sugar",
                quantity: 1,
                price: price || 150000,
                group: serviceGroup
            };

            // L·∫•y container ch·ª©a c√°c nh√≥m d·ªãch v·ª•
            const container = document.getElementById('selected-services-container');

            // X√≥a b·∫£ng tr·ªëng ban ƒë·∫ßu
            const emptyTable = container.querySelector('div > table');
            if (emptyTable) {
                emptyTable.closest('div').remove();
            }

            // T√¨m nh√≥m d·ªãch v·ª• t∆∞∆°ng ·ª©ng, n·∫øu kh√¥ng t·ªìn t·∫°i th√¨ t·∫°o m·ªõi
            let groupElement = container.querySelector(`.service-group[data-group="${serviceGroup}"]`);

            if (!groupElement) {
                // T·∫°o nh√≥m d·ªãch v·ª• m·ªõi
                groupElement = document.createElement('div');
                groupElement.className = 'service-group';
                groupElement.setAttribute('data-group', serviceGroup);
                groupElement.style.border = '1px solid #ddd';
                groupElement.style.borderRadius = '4px';
                groupElement.style.marginBottom = '15px';

                // T·∫°o header cho nh√≥m
                const groupHeader = document.createElement('div');
                groupHeader.style.backgroundColor = '#f8f9fa';
                groupHeader.style.padding = '8px 12px';
                groupHeader.style.fontWeight = 'bold';
                groupHeader.style.borderBottom = '1px solid #ddd';
                groupHeader.textContent = `Nh√≥m: ${serviceGroup}`;

                // T·∫°o b·∫£ng cho nh√≥m
                const table = document.createElement('table');
                table.style.width = '100%';
                table.style.borderCollapse = 'collapse';
                table.style.fontSize = '12px';

                // T·∫°o ti√™u ƒë·ªÅ b·∫£ng
                const thead = document.createElement('thead');
                thead.innerHTML = `
                    <tr style="background-color: #f5f5f5;">
                        <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">STT</th>
                        <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">T√™n d·ªãch v·ª•</th>
                        <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">S·ªë l∆∞·ª£ng</th>
                        <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">ƒê∆°n gi√°</th>
                        <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Th√†nh ti·ªÅn</th>
                        <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Thao t√°c</th>
                    </tr>
                `;

                // T·∫°o tbody cho b·∫£ng
                const tbody = document.createElement('tbody');

                // Gh√©p c√°c ph·∫ßn
                table.appendChild(thead);
                table.appendChild(tbody);
                groupElement.appendChild(groupHeader);
                groupElement.appendChild(table);

                // Th√™m nh√≥m v√†o container
                container.appendChild(groupElement);
            }

            // L·∫•y tbody c·ªßa b·∫£ng
            const tableBody = groupElement.querySelector('table tbody');

            // T·∫°o STT d·ª±a tr√™n s·ªë h√†ng hi·ªán t·∫°i
            const stt = tableBody.children.length + 1;

            // T·∫°o m·ªôt h√†ng m·ªõi
            const newRow = document.createElement('tr');
            newRow.setAttribute('data-service', serviceInfo.name);
            newRow.innerHTML = `
                <td style="padding: 8px; border-bottom: 1px solid #ddd;">${stt}</td>
                <td style="padding: 8px; border-bottom: 1px solid #ddd;">${serviceInfo.name}</td>
                <td style="padding: 8px; border-bottom: 1px solid #ddd;">
                    <input type="number" value="${serviceInfo.quantity}" min="1" style="width: 60px; padding: 4px;" onchange="updateServiceQuantity(this)">
                </td>
                <td style="padding: 8px; border-bottom: 1px solid #ddd;">${formatCurrency(serviceInfo.price)}</td>
                <td style="padding: 8px; border-bottom: 1px solid #ddd;" class="service-total">${formatCurrency(serviceInfo.price * serviceInfo.quantity)}</td>
                <td style="padding: 8px; border-bottom: 1px solid #ddd;">
                    <button class="btn danger" onclick="removeSelectedService(this)" style="padding: 2px 8px; font-size: 10px;">X√≥a</button>
                </td>
            `;

            // Th√™m h√†ng v√†o b·∫£ng
            tableBody.appendChild(newRow);
        }

        // C·∫≠p nh·∫≠t s·ªë l∆∞·ª£ng d·ªãch v·ª•
        function updateServiceQuantity(input) {
            const row = input.closest('tr');
            const quantity = parseInt(input.value) || 1;
            const price = parseInt(row.querySelector('td:nth-child(4)').textContent.replace(/[^\d]/g, '')) || 0;
            const totalCell = row.querySelector('.service-total');

            totalCell.textContent = formatCurrency(price * quantity);
        }

        // X√≥a d·ªãch v·ª• kh·ªèi danh s√°ch ƒë√£ ch·ªçn
        function removeSelectedService(button) {
            const row = button.closest('tr');
            const tbody = row.closest('tbody');
            const groupElement = row.closest('.service-group');
            const container = document.getElementById('selected-services-container');

            // X√≥a h√†ng
            row.remove();

            // C·∫≠p nh·∫≠t l·∫°i STT trong nh√≥m
            const rows = tbody.querySelectorAll('tr');
            rows.forEach((row, index) => {
                row.querySelector('td:first-child').textContent = index + 1;
            });

            // Ki·ªÉm tra n·∫øu nh√≥m kh√¥ng c√≤n d·ªãch v·ª• n√†o
            if (rows.length === 0) {
                // X√≥a nh√≥m
                groupElement.remove();
            }

            // Ki·ªÉm tra n·∫øu kh√¥ng c√≤n nh√≥m n√†o
            const allGroups = document.querySelectorAll('.service-group');
            if (allGroups.length === 0) {
                // T·∫°o b·∫£ng tr·ªëng
                const emptyTableDiv = document.createElement('div');
                emptyTableDiv.style.border = '1px solid #ddd';
                emptyTableDiv.style.borderRadius = '4px';
                emptyTableDiv.style.marginBottom = '15px';

                emptyTableDiv.innerHTML = `
                    <table style="width: 100%; border-collapse: collapse; font-size: 12px;">
                        <thead>
                            <tr style="background-color: #f5f5f5;">
                                <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">STT</th>
                                <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">T√™n d·ªãch v·ª•</th>
                                <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">S·ªë l∆∞·ª£ng</th>
                                <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">ƒê∆°n gi√°</th>
                                <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Th√†nh ti·ªÅn</th>
                                <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Thao t√°c</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr id="empty-service-row">
                                <td colspan="6" style="text-align: center; padding: 15px; color: #999; font-style: italic;">
                                    Ch∆∞a ch·ªçn d·ªãch v·ª• n√†o
                                </td>
                            </tr>
                        </tbody>
                    </table>
                `;

                container.appendChild(emptyTableDiv);
            }
        }

        // ƒê·ªãnh d·∫°ng ti·ªÅn t·ªá
        function formatCurrency(amount) {
            return new Intl.NumberFormat('vi-VN', { style: 'currency', currency: 'VND' }).format(amount);
        }

        // File Upload Popup Functions
        function openFileUploadPopup() {
            document.getElementById('fileUploadPopup').style.display = 'block';
            // Reset upload method to file by default
            selectUploadMethod('file');
            // Reset file input and preview
            document.getElementById('fileInput').value = '';
            document.getElementById('filePreview').style.display = 'none';
        }

        function closeFileUploadPopup() {
            document.getElementById('fileUploadPopup').style.display = 'none';
            stopCameraScan();
        }

        function selectUploadMethod(method) {
            // Reset both options
            document.getElementById('fileOption').style.borderColor = '#ddd';
            document.getElementById('fileOption').style.backgroundColor = '#f5f5f5';
            document.getElementById('cameraOption').style.borderColor = '#ddd';
            document.getElementById('cameraOption').style.backgroundColor = '#f5f5f5';

            // Show selected option
            if (method === 'file') {
                document.getElementById('fileOption').style.borderColor = '#2196F3';
                document.getElementById('fileOption').style.backgroundColor = '#e3f2fd';
                document.getElementById('fileUploadArea').style.display = 'block';
                document.getElementById('cameraScanArea').style.display = 'none';
                stopCameraScan();
            } else if (method === 'camera') {
                document.getElementById('cameraOption').style.borderColor = '#2196F3';
                document.getElementById('cameraOption').style.backgroundColor = '#e3f2fd';
                document.getElementById('fileUploadArea').style.display = 'none';
                document.getElementById('cameraScanArea').style.display = 'block';
            }
        }

        // Handle file selection
        document.getElementById('fileInput').addEventListener('change', function (e) {
            if (e.target.files && e.target.files[0]) {
                const file = e.target.files[0];

                // Validate file size (10MB limit)
                if (file.size > 10 * 1024 * 1024) {
                    alert('T·ªáp qu√° l·ªõn. Vui l√≤ng ch·ªçn t·ªáp nh·ªè h∆°n 10MB.');
                    return;
                }

                // Validate file type
                const validTypes = ['application/pdf', 'image/jpeg', 'image/png', 'image/jpg'];
                if (!validTypes.includes(file.type)) {
                    alert('ƒê·ªãnh d·∫°ng t·ªáp kh√¥ng ƒë∆∞·ª£c h·ªó tr·ª£. Vui l√≤ng ch·ªçn t·ªáp PDF, JPG ho·∫∑c PNG.');
                    return;
                }

                // Show file preview
                showFilePreview(file);
            }
        });

        function showFilePreview(file) {
            const previewContainer = document.getElementById('filePreview');
            const fileNameElement = document.getElementById('previewFileName');
            const previewContent = document.getElementById('previewContent');

            // Set file name
            fileNameElement.textContent = file.name;

            // Clear previous preview
            previewContent.innerHTML = '';

            if (file.type.startsWith('image/')) {
                // Image preview
                const img = document.createElement('img');
                img.style.maxWidth = '100%';
                img.style.maxHeight = '200px';
                img.src = URL.createObjectURL(file);
                previewContent.appendChild(img);
            } else if (file.type === 'application/pdf') {
                // PDF preview
                const pdfIcon = document.createElement('div');
                pdfIcon.style.fontSize = '64px';
                pdfIcon.textContent = 'üìÑ';
                previewContent.appendChild(pdfIcon);

                const pdfName = document.createElement('div');
                pdfName.style.marginTop = '10px';
                pdfName.style.fontSize = '14px';
                previewContent.appendChild(pdfName);
            }

            // Show preview
            previewContainer.style.display = 'block';
        }

        function removeSelectedFile() {
            document.getElementById('fileInput').value = '';
            document.getElementById('filePreview').style.display = 'none';
        }

        // Camera scan functions
        let stream = null;
        let canvas = null;
        let capturedImages = [];

        function startCameraScan() {
            document.getElementById('startCameraScan').style.display = 'none';
            const cameraPreview = document.getElementById('cameraPreview');
            const camera = document.getElementById('camera');
            const cameraButtons = document.getElementById('cameraButtons');
            const capturedPhotosSection = document.getElementById('capturedPhotosSection');

            // Clear previously captured images
            capturedImages = [];
            updateCapturedPhotosDisplay();

            // Create canvas for capturing
            canvas = document.createElement('canvas');
            canvas.width = 640;
            canvas.height = 480;

            // Request camera access
            navigator.mediaDevices.getUserMedia({ video: { facingMode: 'environment' } })
                .then(function (mediaStream) {
                    stream = mediaStream;
                    const video = document.createElement('video');
                    video.style.width = '100%';
                    video.style.height = '100%';
                    video.srcObject = stream;
                    video.autoplay = true;
                    video.playsInline = true;

                    cameraPreview.innerHTML = '';
                    cameraPreview.appendChild(video);

                    // Show all necessary elements with proper flex display
                    camera.style.display = 'flex';
                    cameraButtons.style.display = 'flex';
                    cameraButtons.style.justifyContent = 'center';
                    capturedPhotosSection.style.display = 'flex';
                })
                .catch(function (err) {
                    alert('Kh√¥ng th·ªÉ truy c·∫≠p camera: ' + err.message);
                });
        }

        function stopCameraScan() {
            if (stream) {
                stream.getTracks().forEach(track => track.stop());
                stream = null;
            }

            const cameraPreview = document.getElementById('cameraPreview');
            const cameraButtons = document.getElementById('cameraButtons');
            const camera = document.getElementById('camera');
            const capturedPhotosSection = document.getElementById('capturedPhotosSection');

            cameraPreview.innerHTML = '';
            cameraButtons.style.display = 'none';
            camera.style.display = 'none';
            capturedPhotosSection.style.display = 'none';
            document.getElementById('startCameraScan').style.display = 'block';
        }

        function captureImage() {
            if (!stream) return;

            const video = document.querySelector('#cameraPreview video');
            if (!video) return;

            // Draw video frame to canvas
            canvas.getContext('2d').drawImage(video, 0, 0, canvas.width, canvas.height);

            // Convert canvas to blob
            canvas.toBlob(function (blob) {
                // Save image in array
                capturedImages.push(blob);

                // Update the display
                updateCapturedPhotosDisplay();

                // Show success feedback
                //alert('·∫¢nh ƒë√£ ƒë∆∞·ª£c ch·ª•p th√†nh c√¥ng!');
            }, 'image/jpeg');
        }

        function updateCapturedPhotosDisplay() {
            const photosCountElement = document.getElementById('photosCount');
            const capturedPhotosContainer = document.getElementById('capturedPhotos');

            // Update count
            photosCountElement.textContent = capturedImages.length;

            // Clear and rebuild thumbnails
            capturedPhotosContainer.innerHTML = '';

            if (capturedImages.length === 0) {
                const emptyMessage = document.createElement('div');
                emptyMessage.style.color = '#666';
                emptyMessage.style.padding = '20px';
                emptyMessage.style.fontSize = '14px';
                emptyMessage.textContent = 'Ch∆∞a ch·ª•p ·∫£nh n√†o';
                capturedPhotosContainer.appendChild(emptyMessage);
                return;
            }

            // Create thumbnails for each captured image
            capturedImages.forEach((blob, index) => {
                const thumbnailContainer = document.createElement('div');
                thumbnailContainer.style.position = 'relative';
                thumbnailContainer.style.width = '100px';
                thumbnailContainer.style.height = '100px';
                thumbnailContainer.style.border = '1px solid #ddd';
                thumbnailContainer.style.borderRadius = '4px';
                thumbnailContainer.style.overflow = 'hidden';
                thumbnailContainer.style.backgroundColor = '#f0f0f0';

                const img = document.createElement('img');
                img.src = URL.createObjectURL(blob);
                img.style.width = '100%';
                img.style.height = '100%';
                img.style.objectFit = 'cover';

                const removeButton = document.createElement('button');
                removeButton.innerHTML = '&times;';
                removeButton.style.position = 'absolute';
                removeButton.style.top = '2px';
                removeButton.style.right = '2px';
                removeButton.style.width = '20px';
                removeButton.style.height = '20px';
                removeButton.style.border = 'none';
                removeButton.style.borderRadius = '50%';
                removeButton.style.backgroundColor = 'rgba(244, 67, 54, 0.8)';
                removeButton.style.color = 'white';
                removeButton.style.cursor = 'pointer';
                removeButton.style.fontSize = '12px';
                removeButton.style.display = 'flex';
                removeButton.style.justifyContent = 'center';
                removeButton.style.alignItems = 'center';
                removeButton.onclick = function () {
                    // Remove this image
                    capturedImages.splice(index, 1);
                    updateCapturedPhotosDisplay();
                };

                thumbnailContainer.appendChild(img);
                thumbnailContainer.appendChild(removeButton);
                capturedPhotosContainer.appendChild(thumbnailContainer);
            });
        }

        function generatePDF() {
            if (capturedImages.length === 0) {
                alert('Vui l√≤ng ch·ª•p √≠t nh·∫•t m·ªôt ·∫£nh tr∆∞·ªõc khi t·∫°o PDF');
                return;
            }

            // For demo purposes, we'll just convert the first image to a PDF-like file
            // In a real application, you would use a library like jsPDF to merge images
            const pdfBlob = new Blob([capturedImages[0]], { type: 'application/pdf' });
            const file = new File([pdfBlob], 'merged_document.pdf', { type: 'application/pdf' });

            // Show preview of the generated PDF
            showFilePreview(file);

            // Provide feedback
            alert(`ƒê√£ t·∫°o PDF t·ª´ ${capturedImages.length} ·∫£nh th√†nh c√¥ng!`);
        }

        function uploadSelectedFile() {
            // Here you would typically handle the file upload to your server
            // For demo purposes, we'll just show a success message
            alert('T·ªáp ƒë√£ ƒë∆∞·ª£c t·∫£i l√™n th√†nh c√¥ng!');
            closeFileUploadPopup();
        }
    </script>
</body>

</html>
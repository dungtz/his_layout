<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>HIS - Qu·∫£n l√Ω B·∫£o hi·ªÉm y t·∫ø</title>
    <style>
        :root {
            --bg: #f6f7f9;
            --card: #fff;
            --line: #e5e7eb;
            --txt: #111827;
            --muted: #6b7280;
            --primary: #2563eb;
            --secondary: #4b5563;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --sidebar-width: 280px;
        }

        * {
            box-sizing: border-box;
        }

        html,
        body {
            height: 100%;
            margin: 0;
            font: 14px/1.45 system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
            color: var(--txt);
            background: var(--bg);
        }

        /* Layout t·ªïng th·ªÉ */
        .container {
            display: flex;
            height: 100vh;
            overflow: hidden;
        }

        /* Sidebar tr√°i */
        .sidebar {
            width: var(--sidebar-width);
            background: var(--card);
            border-right: 1px solid var(--line);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* Main content */
        .main-content {
            flex: 1;
            overflow-y: auto;
            padding: 16px;
            background: var(--bg);
        }

        /* Header chung */
        .header {
            padding: 12px 16px;
            background: var(--card);
            border-bottom: 1px solid var(--line);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h2 {
            margin: 0;
            font-size: 16px;
            font-weight: 600;
        }

        .header-actions {
            display: flex;
            gap: 8px;
        }

        /* Logo styles */
        .logo-link {
            display: flex;
            align-items: center;
            text-decoration: none;
            color: inherit;
            padding: 16px;
            border-bottom: 1px solid var(--line);
        }

        .logo {
            width: 40px;
            height: 40px;
            background-color: #4CAF50;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 18px;
        }

        /* Navigation menu */
        .nav-menu {
            flex: 1;
            overflow-y: auto;
            padding: 8px;
        }

        .nav-item {
            display: flex;
            align-items: center;
            padding: 10px 12px;
            margin-bottom: 4px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
        }

        .nav-item:hover {
            background: #f3f4f6;
        }

        .nav-item.active {
            background: #dbeafe;
            color: var(--primary);
            font-weight: 500;
        }

        .nav-item-icon {
            margin-right: 10px;
            width: 20px;
            text-align: center;
        }

        /* Button styles */
        .btn {
            padding: 8px 12px;
            border: 1px solid var(--line);
            border-radius: 8px;
            background: #fff;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }

        .btn:hover {
            background: #f9fafb;
        }

        .btn.primary {
            background: var(--primary);
            color: #fff;
            border-color: var(--primary);
        }

        .btn.primary:hover {
            background: #1d4ed8;
        }

        .btn.success {
            background: var(--success);
            color: #fff;
            border-color: var(--success);
        }

        .btn.success:hover {
            background: #059669;
        }

        .btn.warning {
            background: var(--warning);
            color: #fff;
            border-color: var(--warning);
        }

        .btn.warning:hover {
            background: #d97706;
        }

        .btn.danger {
            background: var(--danger);
            color: #fff;
            border-color: var(--danger);
        }

        .btn.danger:hover {
            background: #dc2626;
        }

        .btn-small {
            font-size: 11px;
            padding: 4px 8px;
        }

        /* Input styles */
        input[type="text"],
        input[type="number"],
        input[type="date"],
        input[type="time"],
        select,
        textarea {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid var(--line);
            border-radius: 8px;
            background: #fff;
            outline: none;
            font-size: 14px;
        }

        textarea {
            min-height: 80px;
            resize: vertical;
        }

        /* Card styles */
        .card {
            background: var(--card);
            border: 1px solid var(--line);
            border-radius: 12px;
            box-shadow: 0 1px 0 rgba(0, 0, 0, .02);
            margin-bottom: 16px;
            overflow: hidden;
        }

        .card-header {
            padding: 12px 16px;
            border-bottom: 1px solid var(--line);
            font-weight: 600;
            font-size: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .card-body {
            padding: 16px;
        }

        /* Table styles */
        .table {
            width: 100%;
            border-collapse: collapse;
            background: var(--card);
            border-radius: 12px;
            overflow: hidden;
        }

        .table th {
            text-align: left;
            padding: 12px 16px;
            background: #f9fafb;
            border-bottom: 2px solid var(--line);
            font-size: 12px;
            font-weight: 600;
            color: var(--secondary);
            white-space: nowrap;
        }

        .table td {
            padding: 12px 16px;
            border-bottom: 1px solid var(--line);
            font-size: 13px;
        }

        .table tbody tr:hover {
            background: #f9fafb;
        }

        .table tbody tr:last-child td {
            border-bottom: none;
        }

        /* Status badges */
        .badge {
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 500;
            display: inline-block;
        }

        .badge.success {
            background: #d1fae5;
            color: #065f46;
        }

        .badge.warning {
            background: #fef3c7;
            color: #92400e;
        }

        .badge.danger {
            background: #fee2e2;
            color: #991b1b;
        }

        .badge.info {
            background: #dbeafe;
            color: #1e40af;
        }

        /* Grid layouts */
        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        .grid-3 {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 12px;
        }

        .grid-4 {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
        }

        /* Field styles */
        .field {
            display: flex;
            flex-direction: column;
            gap: 6px;
            margin-bottom: 12px;
        }

        .field label {
            font-size: 12px;
            color: var(--muted);
            font-weight: 500;
        }

        /* Filter section */
        .filter-section {
            display: flex;
            gap: 12px;
            margin-bottom: 16px;
            padding: 16px;
            background: #f9fafb;
            border-radius: 12px;
        }

        /* Form actions */
        .form-actions {
            display: flex;
            gap: 8px;
            margin-top: 16px;
            justify-content: flex-end;
        }

        /* Pagination */
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 4px;
            margin-top: 16px;
        }

        .page-btn {
            width: 32px;
            height: 32px;
            border: 1px solid var(--line);
            background: #fff;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .page-btn:hover {
            background: #f3f4f6;
        }

        .page-btn.active {
            background: var(--primary);
            color: #fff;
            border-color: var(--primary);
        }

        /* Scrollable content */
        .scrollable {
            max-height: 400px;
            overflow-y: auto;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: #fff;
            border-radius: 12px;
            padding: 20px;
            max-width: 800px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--line);
        }

        .modal-title {
            font-size: 18px;
            font-weight: 600;
        }

        .close-modal {
            font-size: 24px;
            cursor: pointer;
            color: var(--muted);
        }

        /* Detail info */
        .detail-info {
            background: #f9fafb;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 16px;
        }

        .detail-info h3 {
            margin: 0 0 12px 0;
            font-size: 16px;
            font-weight: 600;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 6px;
            font-size: 13px;
        }

        .detail-label {
            color: var(--muted);
        }

        .detail-value {
            font-weight: 500;
        }

        /* Section title */
        .section-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 16px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--line);
        }

        /* Import/Export section */
        .import-export-section {
            background: #f9fafb;
            padding: 16px;
            border-radius: 12px;
            margin-bottom: 16px;
            display: flex;
            gap: 12px;
            align-items: center;
        }

        /* Data validation */
        .validation-message {
            color: var(--danger);
            font-size: 12px;
            margin-top: 4px;
        }

        .input-error {
            border-color: var(--danger) !important;
        }

        /* Responsive adjustments */
        @media (max-width: 1200px) {
            :root {
                --sidebar-width: 250px;
            }

            .grid-4 {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
                height: auto;
                max-height: 200px;
            }

            .grid-2,
            .grid-3,
            .grid-4 {
                grid-template-columns: 1fr;
            }

            .filter-section {
                flex-direction: column;
            }

            .table-container {
                overflow-x: auto;
            }
        }

        /* File upload area */
        .file-upload-area {
            border: 2px dashed var(--line);
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
            margin-bottom: 16px;
        }

        .file-upload-area:hover {
            border-color: var(--primary);
            background: #f0f9ff;
        }

        /* Notice box */
        .notice-box {
            background: #f0f9ff;
            border: 1px solid #bfdbfe;
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 16px;
        }

        .notice-box.warning {
            background: #fef3c7;
            border-color: #fcd34d;
        }

        .notice-box.success {
            background: #d1fae5;
            border-color: #34d399;
        }

        .notice-box.danger {
            background: #fee2e2;
            border-color: #fca5a5;
        }
    </style>
</head>

<body>
    <div class="container">
        <!-- Sidebar tr√°i: Danh s√°ch b·ªánh nh√¢n -->
        <div class="sidebar">
            <a href="home.html" class="logo-link">
                <div class="logo">HIS</div>
            </a>
            
            <div style="padding: 12px; border-bottom: 1px solid var(--line);">
                <div style="font-weight: 600; margin-bottom: 8px; font-size: 14px;">Danh s√°ch b·ªánh nh√¢n</div>
                <input type="text" placeholder="Nh·∫≠p t√™n b·ªánh nh√¢n..." id="patientSearch">
            </div>
            
            <div class="nav-menu" id="patientList">
                <!-- Danh s√°ch b·ªánh nh√¢n -->
                <div class="nav-item patient-item active" data-patient-id="BN001">
                    <div style="font-weight: 500;">Nguy·ªÖn VƒÉn A</div>
                    <div style="font-size: 12px; color: var(--muted);">S·ªë BHYT: 0123456789</div>
                    <div style="font-size: 12px; color: var(--muted);">Ng√†y sinh: 1988-01-01</div>
                </div>
                <div class="nav-item patient-item" data-patient-id="BN002">
                    <div style="font-weight: 500;">Tr·∫ßn Th·ªã B</div>
                    <div style="font-size: 12px; color: var(--muted);">S·ªë BHYT: 0123456790</div>
                    <div style="font-size: 12px; color: var(--muted);">Ng√†y sinh: 1975-05-15</div>
                </div>
                <div class="nav-item patient-item" data-patient-id="BN003">
                    <div style="font-weight: 500;">Tr·∫ßn VƒÉn C</div>
                    <div style="font-size: 12px; color: var(--muted);">S·ªë BHYT: 0123456791</div>
                    <div style="font-size: 12px; color: var(--muted);">Ng√†y sinh: 1990-08-20</div>
                </div>
                <div class="nav-item patient-item" data-patient-id="BN004">
                    <div style="font-weight: 500;">Ph·∫°m Th·ªã D</div>
                    <div style="font-size: 12px; color: var(--muted);">S·ªë BHYT: 0123456792</div>
                    <div style="font-size: 12px; color: var(--muted);">Ng√†y sinh: 1965-12-10</div>
                </div>
                <div class="nav-item patient-item" data-patient-id="BN005">
                    <div style="font-weight: 500;">L√™ VƒÉn E</div>
                    <div style="font-size: 12px; color: var(--muted);">S·ªë BHYT: 0123456793</div>
                    <div style="font-size: 12px; color: var(--muted);">Ng√†y sinh: 1995-03-25</div>
                </div>
                <div class="nav-item patient-item" data-patient-id="BN006">
                    <div style="font-weight: 500;">Ho√†ng Th·ªã F</div>
                    <div style="font-size: 12px; color: var(--muted);">S·ªë BHYT: 0123456794</div>
                    <div style="font-size: 12px; color: var(--muted);">Ng√†y sinh: 1982-09-12</div>
                </div>
                <div class="nav-item patient-item" data-patient-id="BN007">
                    <div style="font-weight: 500;">ƒê·∫∑ng VƒÉn G</div>
                    <div style="font-size: 12px; color: var(--muted);">S·ªë BHYT: 0123456795</div>
                    <div style="font-size: 12px; color: var(--muted);">Ng√†y sinh: 1979-07-08</div>
                </div>
                <div class="nav-item patient-item" data-patient-id="BN008">
                    <div style="font-weight: 500;">Ng√¥ Th·ªã H</div>
                    <div style="font-size: 12px; color: var(--muted);">S·ªë BHYT: 0123456796</div>
                    <div style="font-size: 12px; color: var(--muted);">Ng√†y sinh: 1985-11-28</div>
                </div>
                <div class="nav-item patient-item" data-patient-id="BN009">
                    <div style="font-weight: 500;">V≈© VƒÉn I</div>
                    <div style="font-size: 12px; color: var(--muted);">S·ªë BHYT: 0123456797</div>
                    <div style="font-size: 12px; color: var(--muted);">Ng√†y sinh: 1992-04-15</div>
                </div>
                <div class="nav-item patient-item" data-patient-id="BN010">
                    <div style="font-weight: 500;">Mai Th·ªã K</div>
                    <div style="font-size: 12px; color: var(--muted);">S·ªë BHYT: 0123456798</div>
                    <div style="font-size: 12px; color: var(--muted);">Ng√†y sinh: 1970-02-03</div>
                </div>
            </div>
            
            <!-- Th√¥ng tin n·ªïi b·∫≠t b·ªánh nh√¢n -->
            <div style="padding: 12px; border-top: 1px solid var(--line);">
                <div style="font-size: 12px; margin-bottom: 8px;">
                    <strong>T·ªïng h·ªì s∆°:</strong> 10
                </div>
                <button class="btn primary" style="width: 100%;" onclick="addNewPatient()">‚ûï Th√™m b·ªánh nh√¢n</button>
            </div>
        </div>

        <!-- Main content: Th√¥ng tin BHYT b·ªánh nh√¢n -->
        <div class="main-content">
            <!-- Header hi·ªÉn th·ªã th√¥ng tin b·ªánh nh√¢n ƒëang ch·ªçn -->
            <div class="header">
                <div>
                    <h2 id="currentPatientName">Qu·∫£n l√Ω B·∫£o hi·ªÉm y t·∫ø - Nguy·ªÖn VƒÉn A</h2>
                    <div style="color: var(--muted); font-size: 12px;" id="currentPatientInfo">
                        M√£ BN: BN001 | S·ªë BHYT: 0123456789 | Ng√†y sinh: 1988-01-01
                    </div>
                </div>
                <div class="header-actions">
                    <button class="btn" onclick="printInsuranceRecord()">üñ®Ô∏è In h·ªì s∆°</button>
                    <button class="btn" onclick="exportPatientData()">üì• Xu·∫•t d·ªØ li·ªáu</button>
                    <button class="btn primary" onclick="showAddRecordModal()">‚ûï Th√™m h·ªì s∆° BHYT</button>
                </div>
            </div>

            <!-- Th√¥ng b√°o quan tr·ªçng -->
            <div class="notice-box warning">
                <strong>L∆∞u √Ω quan tr·ªçng:</strong> Theo Quy·∫øt ƒë·ªãnh 1015/Qƒê-BYT, h·ªì s∆° BHYT ph·∫£i ƒë∆∞·ª£c g·ª≠i l√™n c·ªïng qu·ªëc gia trong v√≤ng 48 gi·ªù t·ª´ ng√†y kh√°m ch·ªØa b·ªánh. Th·ªùi h·∫°n ch·∫≠m nh·∫•t ƒë·ªÉ g·ª≠i h·ªì s∆° th√°ng n√†y l√† ng√†y 28/04/2023.
            </div>

            <!-- Th√¥ng tin chi ti·∫øt b·ªánh nh√¢n -->
            <div class="card">
                <div class="card-header">
                    <span>Th√¥ng tin chi ti·∫øt b·ªánh nh√¢n</span>
                    <button class="btn btn-small" onclick="editPatientInfo()">‚úèÔ∏è S·ª≠a th√¥ng tin</button>
                </div>
                <div class="card-body">
                    <div class="grid-2">
                        <div class="detail-info">
                            <h3>Th√¥ng tin c√° nh√¢n</h3>
                            <div class="detail-row">
                                <div class="detail-label">H·ªç t√™n ƒë·∫ßy ƒë·ªß:</div>
                                <div class="detail-value">Nguy·ªÖn VƒÉn A</div>
                            </div>
                            <div class="detail-row">
                                <div class="detail-label">Gi·ªõi t√≠nh:</div>
                                <div class="detail-value">Nam</div>
                            </div>
                            <div class="detail-row">
                                <div class="detail-label">Ng√†y sinh:</div>
                                <div class="detail-value">1988-01-01 (35 tu·ªïi)</div>
                            </div>
                            <div class="detail-row">
                                <div class="detail-label">S·ªë CMND/CCCD:</div>
                                <div class="detail-value">0123456789</div>
                            </div>
                            <div class="detail-row">
                                <div class="detail-label">ƒê·ªãa ch·ªâ th∆∞·ªùng tr√∫:</div>
                                <div class="detail-value">123 ƒê∆∞·ªùng ABC, Qu·∫≠n 1, TP. HCM</div>
                            </div>
                        </div>
                        <div class="detail-info">
                            <h3>Th√¥ng tin b·∫£o hi·ªÉm</h3>
                            <div class="detail-row">
                                <div class="detail-label">S·ªë th·∫ª BHYT:</div>
                                <div class="detail-value">0123456789</div>
                            </div>
                            <div class="detail-row">
                                <div class="detail-label">Hi·ªáu l·ª±c t·ª´:</div>
                                <div class="detail-value">2022-01-01</div>
                            </div>
                            <div class="detail-row">
                                <div class="detail-label">Hi·ªáu l·ª±c ƒë·∫øn:</div>
                                <div class="detail-value">2023-12-31</div>
                            </div>
                            <div class="detail-row">
                                <div class="detail-label">Ph·∫°m vi b·∫£o hi·ªÉm:</div>
                                <div class="detail-value">Cao c·∫•p</div>
                            </div>
                            <div class="detail-row">
                                <div class="detail-label">Tr·∫°ng th√°i th·∫ª:</div>
                                <div class="detail-value"><span class="badge success">Hi·ªáu l·ª±c</span></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- N·ªôi dung ch√≠nh: XML Master v√† 15 XML theo quy ƒë·ªãnh -->
            <div class="card" style="margin-top: 16px;">
                <div class="card-header">
                    <span>XML Master - Th√¥ng tin c∆° s·ªü d·ªØ li·ªáu ch√≠nh</span>
                    <div>
                        <button class="btn btn-small" onclick="viewXmlMaster()">üëÅÔ∏è Xem XML</button>
                        <button class="btn btn-small" onclick="editXmlMaster()">‚úèÔ∏è Ch·ªânh s·ª≠a</button>
                        <button class="btn btn-small primary" onclick="saveXmlMaster()">üíæ L∆∞u</button>
                    </div>
                </div>
                <div class="card-body">
                    <div style="background: #f8fafc; padding: 16px; border-radius: 8px; font-family: monospace; font-size: 12px; max-height: 300px; overflow-y: auto;">
                        <!-- XML Master m·∫´u -->
                        &lt;?xml version="1.0" encoding="UTF-8"?&gt;<br>
                        &lt;HOSO_BHYT&gt;<br>
                        &nbsp;&nbsp;&lt;MAU_HOSO version="1.0"&gt;<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&lt;MA_BN&gt;BN001&lt;/MA_BN&gt;<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&lt;HO_TEN&gt;Nguy·ªÖn VƒÉn A&lt;/HO_TEN&gt;<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&lt;NAM_SINH&gt;1988&lt;/NAM_SINH&gt;<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&lt;GIOI_TINH&gt;1&lt;/GIOI_TINH&gt;<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&lt;SO_BHYT&gt;0123456789&lt;/SO_BHYT&gt;<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&lt;MA_BS&gt;BS001&lt;/MA_BS&gt;<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&lt;NGAY_KHAM&gt;2023-04-20&lt;/NGAY_KHAM&gt;<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&lt;MA_DV&gt;KB001&lt;/MA_DV&gt;<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&lt;TEN_DV&gt;Kh√°m b·ªánh t·ªïng qu√°t&lt;/TEN_DV&gt;<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&lt;DON_GIA&gt;50000&lt;/DON_GIA&gt;<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&lt;THANH_TIEN&gt;50000&lt;/THANH_TIEN&gt;<br>
                        &nbsp;&nbsp;&lt;/MAU_HOSO&gt;<br>
                        &lt;/HOSO_BHYT&gt;
                    </div>
                </div>
            </div>

            <!-- 15 XML theo quy ƒë·ªãnh qu·ªëc gia -->
            <div class="card" style="margin-top: 16px;">
                <div class="card-header">
                    <span>15 XML theo quy ƒë·ªãnh c·ªßa B·ªô Y t·∫ø</span>
                    <div>
                        <button class="btn btn-small" onclick="exportAllXml()">üì• Xu·∫•t t·∫•t c·∫£ XML</button>
                        <button class="btn btn-small primary" onclick="validateXmlData()">‚úÖ Validate XML</button>
                        <button class="btn btn-small warning" onclick="sendToInsurancePortal()">üì§ G·ª≠i l√™n c·ªïng</button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="grid-2" style="gap: 16px;">
                        <!-- XML 1 -->
                        <div style="border: 1px solid var(--line); border-radius: 8px; padding: 12px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <div style="font-weight: 600;">1. TTHOSO_NHANKHAU.xml</div>
                                <div>
                                    <button class="btn btn-small">üëÅÔ∏è</button>
                                    <button class="btn btn-small">‚úèÔ∏è</button>
                                </div>
                            </div>
                            <div style="color: var(--muted); font-size: 12px; margin-bottom: 4px;">Th√¥ng tin nh√¢n kh·∫©u b·ªánh nh√¢n</div>
                            <div class="badge success">S·∫µn s√†ng</div>
                        </div>

                        <!-- XML 2 -->
                        <div style="border: 1px solid var(--line); border-radius: 8px; padding: 12px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <div style="font-weight: 600;">2. TTHOSO_BHYT.xml</div>
                                <div>
                                    <button class="btn btn-small">üëÅÔ∏è</button>
                                    <button class="btn btn-small">‚úèÔ∏è</button>
                                </div>
                            </div>
                            <div style="color: var(--muted); font-size: 12px; margin-bottom: 4px;">Th√¥ng tin th·∫ª b·∫£o hi·ªÉm y t·∫ø</div>
                            <div class="badge success">S·∫µn s√†ng</div>
                        </div>

                        <!-- XML 3 -->
                        <div style="border: 1px solid var(--line); border-radius: 8px; padding: 12px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <div style="font-weight: 600;">3. TTHOSO_KCB.xml</div>
                                <div>
                                    <button class="btn btn-small">üëÅÔ∏è</button>
                                    <button class="btn btn-small">‚úèÔ∏è</button>
                                </div>
                            </div>
                            <div style="color: var(--muted); font-size: 12px; margin-bottom: 4px;">Th√¥ng tin kh√°m ch·ªØa b·ªánh</div>
                            <div class="badge success">S·∫µn s√†ng</div>
                        </div>

                        <!-- XML 4 -->
                        <div style="border: 1px solid var(--line); border-radius: 8px; padding: 12px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <div style="font-weight: 600;">4. DS_KHAMBENH.xml</div>
                                <div>
                                    <button class="btn btn-small">üëÅÔ∏è</button>
                                    <button class="btn btn-small">‚úèÔ∏è</button>
                                </div>
                            </div>
                            <div style="color: var(--muted); font-size: 12px; margin-bottom: 4px;">Danh s√°ch kh√°m b·ªánh</div>
                            <div class="badge success">S·∫µn s√†ng</div>
                        </div>

                        <!-- XML 5 -->
                        <div style="border: 1px solid var(--line); border-radius: 8px; padding: 12px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <div style="font-weight: 600;">5. DS_DICHVU.xml</div>
                                <div>
                                    <button class="btn btn-small">üëÅÔ∏è</button>
                                    <button class="btn btn-small">‚úèÔ∏è</button>
                                </div>
                            </div>
                            <div style="color: var(--muted); font-size: 12px; margin-bottom: 4px;">Danh s√°ch d·ªãch v·ª• y t·∫ø</div>
                            <div class="badge warning">Ch∆∞a ho√†n thi·ªán</div>
                        </div>

                        <!-- XML 6 -->
                        <div style="border: 1px solid var(--line); border-radius: 8px; padding: 12px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <div style="font-weight: 600;">6. DS_THUOC.xml</div>
                                <div>
                                    <button class="btn btn-small">üëÅÔ∏è</button>
                                    <button class="btn btn-small">‚úèÔ∏è</button>
                                </div>
                            </div>
                            <div style="color: var(--muted); font-size: 12px; margin-bottom: 4px;">Danh s√°ch thu·ªëc k√™ ƒë∆°n</div>
                            <div class="badge success">S·∫µn s√†ng</div>
                        </div>

                        <!-- XML 7 -->
                        <div style="border: 1px solid var(--line); border-radius: 8px; padding: 12px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <div style="font-weight: 600;">7. CHUANDOAN.xml</div>
                                <div>
                                    <button class="btn btn-small">üëÅÔ∏è</button>
                                    <button class="btn btn-small">‚úèÔ∏è</button>
                                </div>
                            </div>
                            <div style="color: var(--muted); font-size: 12px; margin-bottom: 4px;">Th√¥ng tin ch·∫©n ƒëo√°n b·ªánh</div>
                            <div class="badge success">S·∫µn s√†ng</div>
                        </div>

                        <!-- XML 8 -->
                        <div style="border: 1px solid var(--line); border-radius: 8px; padding: 12px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <div style="font-weight: 600;">8. XETNGHIEM.xml</div>
                                <div>
                                    <button class="btn btn-small">üëÅÔ∏è</button>
                                    <button class="btn btn-small">‚úèÔ∏è</button>
                                </div>
                            </div>
                            <div style="color: var(--muted); font-size: 12px; margin-bottom: 4px;">Th√¥ng tin x√©t nghi·ªám</div>
                            <div class="badge success">S·∫µn s√†ng</div>
                        </div>

                        <!-- XML 9 -->
                        <div style="border: 1px solid var(--line); border-radius: 8px; padding: 12px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <div style="font-weight: 600;">9. XQUANG.xml</div>
                                <div>
                                    <button class="btn btn-small">üëÅÔ∏è</button>
                                    <button class="btn btn-small">‚úèÔ∏è</button>
                                </div>
                            </div>
                            <div style="color: var(--muted); font-size: 12px; margin-bottom: 4px;">Th√¥ng tin x√©t nghi·ªám h√¨nh ·∫£nh</div>
                            <div class="badge warning">Ch∆∞a ho√†n thi·ªán</div>
                        </div>

                        <!-- XML 10 -->
                        <div style="border: 1px solid var(--line); border-radius: 8px; padding: 12px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <div style="font-weight: 600;">10. KETQUA_KCB.xml</div>
                                <div>
                                    <button class="btn btn-small">üëÅÔ∏è</button>
                                    <button class="btn btn-small">‚úèÔ∏è</button>
                                </div>
                            </div>
                            <div style="color: var(--muted); font-size: 12px; margin-bottom: 4px;">K·∫øt qu·∫£ kh√°m ch·ªØa b·ªánh</div>
                            <div class="badge success">S·∫µn s√†ng</div>
                        </div>

                        <!-- XML 11 -->
                        <div style="border: 1px solid var(--line); border-radius: 8px; padding: 12px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <div style="font-weight: 600;">11. THANHTOAN.xml</div>
                                <div>
                                    <button class="btn btn-small">üëÅÔ∏è</button>
                                    <button class="btn btn-small">‚úèÔ∏è</button>
                                </div>
                            </div>
                            <div style="color: var(--muted); font-size: 12px; margin-bottom: 4px;">Th√¥ng tin thanh to√°n</div>
                            <div class="badge success">S·∫µn s√†ng</div>
                        </div>

                        <!-- XML 12 -->
                        <div style="border: 1px solid var(--line); border-radius: 8px; padding: 12px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <div style="font-weight: 600;">12. DMDICHVU.xml</div>
                                <div>
                                    <button class="btn btn-small">üëÅÔ∏è</button>
                                    <button class="btn btn-small">‚úèÔ∏è</button>
                                </div>
                            </div>
                            <div style="color: var(--muted); font-size: 12px; margin-bottom: 4px;">Danh m·ª•c d·ªãch v·ª•</div>
                            <div class="badge success">S·∫µn s√†ng</div>
                        </div>

                        <!-- XML 13 -->
                        <div style="border: 1px solid var(--line); border-radius: 8px; padding: 12px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <div style="font-weight: 600;">13. DMTHUOC.xml</div>
                                <div>
                                    <button class="btn btn-small">üëÅÔ∏è</button>
                                    <button class="btn btn-small">‚úèÔ∏è</button>
                                </div>
                            </div>
                            <div style="color: var(--muted); font-size: 12px; margin-bottom: 4px;">Danh m·ª•c thu·ªëc</div>
                            <div class="badge success">S·∫µn s√†ng</div>
                        </div>

                        <!-- XML 14 -->
                        <div style="border: 1px solid var(--line); border-radius: 8px; padding: 12px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <div style="font-weight: 600;">14. DMCHUANDOAN.xml</div>
                                <div>
                                    <button class="btn btn-small">üëÅÔ∏è</button>
                                    <button class="btn btn-small">‚úèÔ∏è</button>
                                </div>
                            </div>
                            <div style="color: var(--muted); font-size: 12px; margin-bottom: 4px;">Danh m·ª•c ch·∫©n ƒëo√°n ICD-10</div>
                            <div class="badge success">S·∫µn s√†ng</div>
                        </div>

                        <!-- XML 15 -->
                        <div style="border: 1px solid var(--line); border-radius: 8px; padding: 12px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <div style="font-weight: 600;">15. CHITIET_HOSO.xml</div>
                                <div>
                                    <button class="btn btn-small">üëÅÔ∏è</button>
                                    <button class="btn btn-small">‚úèÔ∏è</button>
                                </div>
                            </div>
                            <div style="color: var(--muted); font-size: 12px; margin-bottom: 4px;">Chi ti·∫øt h·ªì s∆° BHYT</div>
                            <div class="badge warning">Ch∆∞a ho√†n thi·ªán</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- L·ªãch s·ª≠ g·ª≠i h·ªì s∆° -->
            <div class="card" style="margin-top: 16px;">
                <div class="card-header">
                    <span>L·ªãch s·ª≠ g·ª≠i h·ªì s∆° l√™n c·ªïng BHYT</span>
                </div>
                <div class="table-container" style="overflow-x: auto;">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>STT</th>
                                <th>Ng√†y g·ª≠i</th>
                                <th>Th·ªùi gian</th>
                                <th>Tr·∫°ng th√°i</th>
                                <th>M√£ ph·∫£n h·ªìi</th>
                                <th>N·ªôi dung ph·∫£n h·ªìi</th>
                                <th>Thao t√°c</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>1</td>
                                <td>2023-04-20</td>
                                <td>10:30:45</td>
                                <td><span class="badge success">Th√†nh c√¥ng</span></td>
                                <td>00</td>
                                <td>X·ª≠ l√Ω th√†nh c√¥ng</td>
                                <td>
                                    <button class="btn btn-small">üëÅÔ∏è</button>
                                </td>
                            </tr>
                            <tr>
                                <td>2</td>
                                <td>2023-04-19</td>
                                <td>16:45:20</td>
                                <td><span class="badge success">Th√†nh c√¥ng</span></td>
                                <td>00</td>
                                <td>X·ª≠ l√Ω th√†nh c√¥ng</td>
                                <td>
                                    <button class="btn btn-small">üëÅÔ∏è</button>
                                </td>
                            </tr>
                            <tr>
                                <td>3</td>
                                <td>2023-04-18</td>
                                <td>09:15:30</td>
                                <td><span class="badge danger">Th·∫•t b·∫°i</span></td>
                                <td>400</td>
                                <td>Th√¥ng tin th·∫ª BHYT kh√¥ng h·ª£p l·ªá</td>
                                <td>
                                    <button class="btn btn-small">üëÅÔ∏è</button>
                                    <button class="btn btn-small primary">üîÑ</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal th√™m h·ªì s∆° BHYT -->
    <div id="addRecordModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Th√™m h·ªì s∆° BHYT m·ªõi</div>
                <div class="close-modal" onclick="closeAddRecordModal()">&times;</div>
            </div>
            
            <div class="grid-2">
                <div class="field">
                    <label>H·ªç t√™n b·ªánh nh√¢n *</label>
                    <input type="text" id="patientName" required>
                </div>
                <div class="field">
                    <label>M√£ b·ªánh nh√¢n</label>
                    <input type="text" id="patientCode">
                </div>
                <div class="field">
                    <label>S·ªë th·∫ª BHYT *</label>
                    <input type="text" id="insuranceNumber" required>
                </div>
                <div class="field">
                    <label>Ng√†y sinh *</label>
                    <input type="date" id="patientDOB" required>
                </div>
                <div class="field">
                    <label>Gi·ªõi t√≠nh *</label>
                    <select id="patientGender" required>
                        <option value="">Ch·ªçn gi·ªõi t√≠nh</option>
                        <option value="nam">Nam</option>
                        <option value="nu">N·ªØ</option>
                        <option value="khac">Kh√°c</option>
                    </select>
                </div>
                <div class="field">
                    <label>Ng√†y kh√°m *</label>
                    <input type="date" id="examinationDate" required>
                </div>
                <div class="field">
                    <label>Khoa kh√°m *</label>
                    <select id="department" required>
                        <option value="">Ch·ªçn khoa</option>
                        <option value="noi">Khoa N·ªôi</option>
                        <option value="ngoai">Khoa Ngo·∫°i</option>
                        <option value="san">Khoa S·∫£n</option>
                        <option value="nha">Khoa Nha Khoa</option>
                    </select>
                </div>
                <div class="field">
                    <label>B√°c sƒ© ph·ª• tr√°ch</label>
                    <select id="doctor">
                        <option value="">Ch·ªçn b√°c sƒ©</option>
                        <option value="bs001">BS. Nguy·ªÖn VƒÉn H√πng</option>
                        <option value="bs002">BS. Tr·∫ßn Th·ªã Hoa</option>
                        <option value="bs003">BS. L√Ω VƒÉn Minh</option>
                    </select>
                </div>
                <div class="field">
                    <label>M√£ d·ªãch v·ª• *</label>
                    <input type="text" id="serviceCode" required>
                </div>
                <div class="field">
                    <label>T√™n d·ªãch v·ª• *</label>
                    <input type="text" id="serviceName" required>
                </div>
                <div class="field">
                    <label>S·ªë l∆∞·ª£ng *</label>
                    <input type="number" id="quantity" value="1" min="1" required>
                </div>
                <div class="field">
                    <label>ƒê∆°n gi√° (VNƒê) *</label>
                    <input type="number" id="unitPrice" required>
                </div>
                <div class="field">
                    <label>Lo·∫°i chi ph√≠ *</label>
                    <select id="expenseType" required>
                        <option value="">Ch·ªçn lo·∫°i chi ph√≠</option>
                        <option value="kham">Kh√°m ch·ªØa b·ªánh</option>
                        <option value="xet_nghiem">X√©t nghi·ªám</option>
                        <option value="nhap_vien">Nh·∫≠p vi·ªán</option>
                        <option value="phau_thuat">Ph·∫´u thu·∫≠t</option>
                        <option value="kham_thai">Kh√°m thai</option>
                    </select>
                </div>
                <div class="field">
                    <label>Ng∆∞·ªùi nh·∫≠p d·ªØ li·ªáu</label>
                    <input type="text" id="dataEntryPerson" value="NV001" readonly>
                </div>
            </div>
            
            <div class="field">
                <label>Ghi ch√∫</label>
                <textarea id="notes" placeholder="Nh·∫≠p ghi ch√∫ (n·∫øu c√≥)"></textarea>
            </div>
            
            <div class="notice-box">
                <strong>L∆∞u √Ω:</strong> Th√¥ng tin nh·∫≠p v√†o ph·∫£i ch√≠nh x√°c theo m·∫´u quy ƒë·ªãnh t·∫°i Quy·∫øt ƒë·ªãnh 1015/Qƒê-BYT ƒë·ªÉ ƒë·∫£m b·∫£o vi·ªác g·ª≠i l√™n c·ªïng qu·ªëc gia th√†nh c√¥ng.
            </div>
            
            <div class="form-actions">
                <button class="btn" onclick="closeAddRecordModal()">H·ªßy</button>
                <button class="btn primary" onclick="saveNewRecord()">L∆∞u h·ªì s∆°</button>
                <button class="btn success" onclick="saveAndSendRecord()">L∆∞u v√† g·ª≠i l√™n c·ªïng</button>
            </div>
        </div>
    </div>

    <!-- Modal nh·∫≠p h√†ng lo·∫°t -->
    <div id="batchUploadModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Nh·∫≠p h√†ng lo·∫°t h·ªì s∆° BHYT</div>
                <div class="close-modal" onclick="closeBatchUploadModal()">&times;</div>
            </div>
            
            <div class="notice-box warning">
                <strong>H∆∞·ªõng d·∫´n nh·∫≠p:</strong>
                <ol style="margin-top: 8px; margin-bottom: 8px; padding-left: 20px;">
                    <li>T·∫£i m·∫´u Excel m·∫´u d∆∞·ªõi ƒë√¢y</li>
                    <li>ƒêi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin theo m·∫´u</li>
                    <li>Upload file Excel ƒë√£ ƒëi·ªÅn</li>
                    <li>Ki·ªÉm tra d·ªØ li·ªáu v√† x√°c nh·∫≠n nh·∫≠p</li>
                </ol>
            </div>
            
            <div class="file-upload-area" onclick="document.getElementById('batchFileInput').click()">
                <input type="file" id="batchFileInput" accept=".xlsx,.xls" style="display: none;">
                <div style="margin-bottom: 8px;">üìÅ</div>
                <div style="font-weight: 500; margin-bottom: 4px;">K√©o v√† th·∫£ file Excel v√†o ƒë√¢y</div>
                <div style="font-size: 12px; color: var(--muted);">ho·∫∑c click ƒë·ªÉ ch·ªçn file</div>
                <div style="font-size: 11px; color: var(--muted); margin-top: 4px;">XLSX, XLS (t·ªëi ƒëa 5MB)</div>
            </div>
            
            <div style="display: flex; gap: 8px;">
                <button class="btn" onclick="downloadTemplate()">üì• T·∫£i m·∫´u Excel</button>
                <button class="btn" onclick="viewImportGuide()">üìö H∆∞·ªõng d·∫´n nh·∫≠p</button>
            </div>
            
            <div style="margin-top: 16px;">
                <h3 style="font-size: 16px; margin-bottom: 8px;">L·ªãch s·ª≠ nh·∫≠p h√†ng lo·∫°t</h3>
                <table class="table">
                    <thead>
                        <tr>
                            <th>STT</th>
                            <th>T√™n file</th>
                            <th>Th·ªùi gian</th>
                            <th>S·ªë b·∫£n ghi</th>
                            <th>Tr·∫°ng th√°i</th>
                            <th>Thao t√°c</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>1</td>
                            <td>Nhap_bhyt_thang4_2023.xlsx</td>
                            <td>2023-04-15 09:30</td>
                            <td>50</td>
                            <td><span class="badge success">Th√†nh c√¥ng</span></td>
                            <td>
                                <button class="btn btn-small">üëÅÔ∏è</button>
                            </td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td>Nhap_bhyt_10_04.xlsx</td>
                            <td>2023-04-10 14:45</td>
                            <td>30</td>
                            <td><span class="badge warning">C√≥ l·ªói</span></td>
                            <td>
                                <button class="btn btn-small">üëÅÔ∏è</button>
                                <button class="btn btn-small">üì•</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <div class="form-actions">
                <button class="btn" onclick="closeBatchUploadModal()">ƒê√≥ng</button>
            </div>
        </div>
    </div>

    <!-- Modal c·∫•u h√¨nh k·∫øt n·ªëi c·ªïng BHYT -->
    <div id="configModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">C·∫•u h√¨nh k·∫øt n·ªëi c·ªïng BHYT</div>
                <div class="close-modal" onclick="closeConfigModal()">&times;</div>
            </div>
            
            <div class="grid-2">
                <div class="field">
                    <label>URL c·ªïng BHYT *</label>
                    <input type="text" id="portalUrl" value="https://api.bhyt.gov.vn/v1" required>
                </div>
                <div class="field">
                    <label>Phi√™n b·∫£n API</label>
                    <input type="text" id="apiVersion" value="1.0" readonly>
                </div>
                <div class="field">
                    <label>M√£ ƒë∆°n v·ªã *</label>
                    <input type="text" id="unitCode" value="DV123456" required>
                </div>
                <div class="field">
                    <label>Token truy c·∫≠p *</label>
                    <input type="password" id="accessToken" required>
                </div>
                <div class="field">
                    <label>Th·ªùi gian timeout (gi√¢y)</label>
                    <input type="number" id="timeout" value="30" min="5" max="300">
                </div>
                <div class="field">
                    <label>Tr·∫°ng th√°i k·∫øt n·ªëi</label>
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <span class="badge success">K·∫øt n·ªëi t·ªët</span>
                        <button class="btn btn-small" onclick="testConnection()">Ki·ªÉm tra k·∫øt n·ªëi</button>
                    </div>
                </div>
            </div>
            
            <div class="notice-box">
                <strong>L∆∞u √Ω b·∫£o m·∫≠t:</strong> Token truy c·∫≠p ph·∫£i ƒë∆∞·ª£c b·∫£o m·∫≠t c·∫©n th·∫≠n v√† thay ƒë·ªïi ƒë·ªãnh k·ª≥ theo quy ƒë·ªãnh c·ªßa c∆° quan BHYT.
            </div>
            
            <div class="form-actions">
                <button class="btn" onclick="closeConfigModal()">H·ªßy</button>
                <button class="btn primary" onclick="saveConfig()">L∆∞u c·∫•u h√¨nh</button>
            </div>
        </div>
    </div>

    <script>
        // Kh·ªüi t·∫°o ng√†y h√¥m nay cho tr∆∞·ªùng ng√†y kh√°m
        document.addEventListener('DOMContentLoaded', function() {
            const today = new Date();
            const dateString = today.toISOString().split('T')[0];
            document.getElementById('examinationDate').value = dateString;
            
            // Th√™m s·ª± ki·ªán cho danh s√°ch b·ªánh nh√¢n
            document.querySelectorAll('.patient-item').forEach(item => {
                item.addEventListener('click', function() {
                    // X√≥a class active kh·ªèi t·∫•t c·∫£ b·ªánh nh√¢n
                    document.querySelectorAll('.patient-item').forEach(patient => {
                        patient.classList.remove('active');
                    });
                    // Th√™m class active cho b·ªánh nh√¢n ƒë∆∞·ª£c ch·ªçn
                    this.classList.add('active');
                    
                    // L·∫•y th√¥ng tin b·ªánh nh√¢n
                    const patientId = this.getAttribute('data-patient-id');
                    const patientName = this.querySelector('div:first-child').textContent;
                    const patientInfo = this.querySelector('div:nth-child(2)').textContent;
                    const patientDob = this.querySelector('div:nth-child(3)').textContent;
                    
                    // C·∫≠p nh·∫≠t th√¥ng tin tr√™n header
                    document.getElementById('currentPatientName').textContent = 'Qu·∫£n l√Ω B·∫£o hi·ªÉm y t·∫ø - ' + patientName;
                    document.getElementById('currentPatientInfo').textContent = 
                        'M√£ BN: ' + patientId + ' | ' + patientInfo + ' | ' + patientDob;
                    
                    // G·ªçi h√†m t·∫£i d·ªØ li·ªáu b·ªánh nh√¢n
                    loadPatientData(patientId, patientName);
                });
            });
            
            // Th√™m ch·ª©c nƒÉng t√¨m ki·∫øm b·ªánh nh√¢n
            document.getElementById('patientSearch').addEventListener('input', function() {
                const searchTerm = this.value.toLowerCase();
                document.querySelectorAll('.patient-item').forEach(patient => {
                    const patientName = patient.querySelector('div:first-child').textContent.toLowerCase();
                    if (patientName.includes(searchTerm)) {
                        patient.style.display = 'block';
                    } else {
                        patient.style.display = 'none';
                    }
                });
            });
        });
        
        // T·∫£i d·ªØ li·ªáu b·ªánh nh√¢n khi ch·ªçn
        function loadPatientData(patientId, patientName) {
            console.log('Loading data for patient:', patientId, patientName);
            
            // ·ªû ƒë√¢y s·∫Ω g·ªçi API ƒë·ªÉ t·∫£i d·ªØ li·ªáu XML cho b·ªánh nh√¢n
            // Hi·ªán t·∫°i ch·ªâ hi·ªÉn th·ªã th√¥ng b√°o
            alert(`üì• ƒêang t·∫£i d·ªØ li·ªáu BHYT cho b·ªánh nh√¢n: ${patientName} (${patientId})`);
            
            // Sau khi t·∫£i xong, c·∫≠p nh·∫≠t tr·∫°ng th√°i c√°c XML
            // updateXmlStatus(patientId);
        }
        
        // C·∫≠p nh·∫≠t tr·∫°ng th√°i c√°c file XML
        function updateXmlStatus(patientId) {
            console.log('Updating XML status for patient:', patientId);
            // ·ªû ƒë√¢y s·∫Ω c·∫≠p nh·∫≠t tr·∫°ng th√°i c·ªßa 15 file XML d·ª±a tr√™n d·ªØ li·ªáu b·ªánh nh√¢n
        }
        
        // Xem XML Master
        function viewXmlMaster() {
            alert('üëÅÔ∏è Xem XML Master');
        }
        
        // Ch·ªânh s·ª≠a XML Master
        function editXmlMaster() {
            alert('‚úèÔ∏è Ch·ªânh s·ª≠a XML Master');
        }
        
        // L∆∞u XML Master
        function saveXmlMaster() {
            alert('üíæ XML Master ƒë√£ ƒë∆∞·ª£c l∆∞u th√†nh c√¥ng!');
        }
        
        // Xu·∫•t t·∫•t c·∫£ XML
        function exportAllXml() {
            alert('üì• ƒêang xu·∫•t t·∫•t c·∫£ file XML...');
        }
        
        // Validate XML
        function validateXmlData() {
            alert('‚úÖ Validate XML th√†nh c√¥ng! T·∫•t c·∫£ file XML ƒë·ªÅu h·ª£p l·ªá.');
        }
        
        // In h·ªì s∆°
        function printInsuranceRecord() {
            alert('üñ®Ô∏è ƒêang in h·ªì s∆° BHYT...');
        }
        
        // Xu·∫•t d·ªØ li·ªáu b·ªánh nh√¢n
        function exportPatientData() {
            alert('üì• ƒêang xu·∫•t d·ªØ li·ªáu b·ªánh nh√¢n...');
        }
        
        // S·ª≠a th√¥ng tin b·ªánh nh√¢n
        function editPatientInfo() {
            alert('‚úèÔ∏è S·ª≠a th√¥ng tin b·ªánh nh√¢n');
        }
        
        // Th√™m b·ªánh nh√¢n m·ªõi
        function addNewPatient() {
            alert('‚ûï Th√™m b·ªánh nh√¢n m·ªõi');
        }
        
        // Hi·ªÉn th·ªã modal th√™m h·ªì s∆°
        function showAddRecordModal() {
            document.getElementById('addRecordModal').style.display = 'flex';
        }
        
        // ƒê√≥ng modal th√™m h·ªì s∆°
        function closeAddRecordModal() {
            document.getElementById('addRecordModal').style.display = 'none';
        }
        
        // L∆∞u h·ªì s∆° m·ªõi
        function saveNewRecord() {
            // Validate form
            if (!validateForm()) {
                return;
            }
            
            // L·∫•y d·ªØ li·ªáu t·ª´ form
            const formData = {
                patientName: document.getElementById('patientName').value,
                patientCode: document.getElementById('patientCode').value,
                insuranceNumber: document.getElementById('insuranceNumber').value,
                patientDOB: document.getElementById('patientDOB').value,
                patientGender: document.getElementById('patientGender').value,
                examinationDate: document.getElementById('examinationDate').value,
                department: document.getElementById('department').value,
                doctor: document.getElementById('doctor').value,
                serviceCode: document.getElementById('serviceCode').value,
                serviceName: document.getElementById('serviceName').value,
                quantity: document.getElementById('quantity').value,
                unitPrice: document.getElementById('unitPrice').value,
                expenseType: document.getElementById('expenseType').value,
                dataEntryPerson: document.getElementById('dataEntryPerson').value,
                notes: document.getElementById('notes').value
            };
            
            console.log('Saving new medical insurance record:', formData);
            alert('‚úÖ H·ªì s∆° BHYT ƒë√£ ƒë∆∞·ª£c l∆∞u th√†nh c√¥ng!');
            closeAddRecordModal();
        }
        
        // L∆∞u v√† g·ª≠i l√™n c·ªïng
        function saveAndSendRecord() {
            saveNewRecord();
            alert('‚úÖ H·ªì s∆° BHYT ƒë√£ ƒë∆∞·ª£c l∆∞u v√† g·ª≠i l√™n c·ªïng qu·ªëc gia!');
        }
        
        // Validate form
        function validateForm() {
            const requiredFields = document.querySelectorAll('#addRecordModal [required]');
            let isValid = true;
            
            requiredFields.forEach(field => {
                if (!field.value.trim()) {
                    field.classList.add('input-error');
                    isValid = false;
                } else {
                    field.classList.remove('input-error');
                }
            });
            
            if (!isValid) {
                alert('‚ùå Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß t·∫•t c·∫£ c√°c tr∆∞·ªùng b·∫Øt bu·ªôc!');
            }
            
            return isValid;
        }
        
        // Hi·ªÉn th·ªã modal nh·∫≠p h√†ng lo·∫°t
        function showBatchUploadModal() {
            document.getElementById('batchUploadModal').style.display = 'flex';
        }
        
        // ƒê√≥ng modal nh·∫≠p h√†ng lo·∫°t
        function closeBatchUploadModal() {
            document.getElementById('batchUploadModal').style.display = 'none';
        }
        
        // T·∫£i m·∫´u Excel
        function downloadTemplate() {
            console.log('Downloading Excel template');
            alert('üì• ƒêang t·∫£i m·∫´u Excel...');
        }
        
        // Hi·ªÉn th·ªã h∆∞·ªõng d·∫´n nh·∫≠p
        function viewImportGuide() {
            console.log('Viewing import guide');
            alert('üìö H∆∞·ªõng d·∫´n nh·∫≠p s·∫Ω ƒë∆∞·ª£c m·ªü trong c·ª≠a s·ªï m·ªõi');
        }
        
        // Hi·ªÉn th·ªã modal c·∫•u h√¨nh
        function showConfigModal() {
            document.getElementById('configModal').style.display = 'flex';
        }
        
        // ƒê√≥ng modal c·∫•u h√¨nh
        function closeConfigModal() {
            document.getElementById('configModal').style.display = 'none';
        }
        
        // L∆∞u c·∫•u h√¨nh
        function saveConfig() {
            const configData = {
                portalUrl: document.getElementById('portalUrl').value,
                apiVersion: document.getElementById('apiVersion').value,
                unitCode: document.getElementById('unitCode').value,
                accessToken: document.getElementById('accessToken').value,
                timeout: document.getElementById('timeout').value
            };
            
            console.log('Saving configuration:', configData);
            alert('‚úÖ C·∫•u h√¨nh ƒë√£ ƒë∆∞·ª£c l∆∞u th√†nh c√¥ng!');
            closeConfigModal();
        }
        
        // Ki·ªÉm tra k·∫øt n·ªëi
        function testConnection() {
            console.log('Testing connection to insurance portal');
            alert('üîÑ ƒêang ki·ªÉm tra k·∫øt n·ªëi ƒë·∫øn c·ªïng BHYT...\n‚úÖ K·∫øt n·ªëi th√†nh c√¥ng!');
        }
        
        // S·ª≠a b·∫£n ghi
        function editRecord(id) {
            console.log('Editing record:', id);
            alert(`S·ª≠a b·∫£n ghi s·ªë ${id}`);
        }
        
        // Xem b·∫£n ghi
        function viewRecord(id) {
            console.log('Viewing record:', id);
            alert(`Xem chi ti·∫øt b·∫£n ghi s·ªë ${id}`);
        }
        
        // X√≥a b·∫£n ghi
        function deleteRecord(id) {
            if (confirm(`B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a b·∫£n ghi s·ªë ${id}?`)) {
                console.log('Deleting record:', id);
                alert(`‚úÖ B·∫£n ghi s·ªë ${id} ƒë√£ ƒë∆∞·ª£c x√≥a!`);
            }
        }
        
        // G·ª≠i l·∫°i b·∫£n ghi
        function resendRecord(id) {
            console.log('Resending record:', id);
            alert(`üîÑ ƒêang g·ª≠i l·∫°i b·∫£n ghi s·ªë ${id} l√™n c·ªïng...`);
        }
        
        // Xu·∫•t Excel
        function exportToExcel() {
            console.log('Exporting data to Excel');
            alert('üìä ƒêang xu·∫•t d·ªØ li·ªáu ra file Excel...');
        }
        
        // L∆∞u t·∫•t c·∫£ d·ªØ li·ªáu
        function saveAllData() {
            console.log('Saving all data');
            alert('üíæ T·∫•t c·∫£ d·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c l∆∞u th√†nh c√¥ng!');
        }
        
        // G·ª≠i l√™n c·ªïng BHYT
        function sendToInsurancePortal() {
            if (confirm('B·∫°n mu·ªën g·ª≠i t·∫•t c·∫£ h·ªì s∆° ch∆∞a g·ª≠i l√™n c·ªïng BHYT?')) {
                console.log('Sending data to insurance portal');
                alert('üì§ ƒêang g·ª≠i d·ªØ li·ªáu l√™n c·ªïng BHYT qu·ªëc gia...');
            }
        }
        
        // X·ª≠ l√Ω upload file h√†ng lo·∫°t
        document.getElementById('batchFileInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                console.log('Uploading batch file:', file.name);
                alert(`üìÅ ƒêang x·ª≠ l√Ω file: ${file.name}`);
            }
        });
        
        // Ph√¢n trang
        document.querySelectorAll('.page-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.page-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                // ·ªû ƒë√¢y s·∫Ω t·∫£i d·ªØ li·ªáu cho trang ƒë∆∞·ª£c ch·ªçn
                console.log('Loading page:', this.textContent);
            });
        });
    </script>
</body>

</html>